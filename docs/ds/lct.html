
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Link Cut Tree · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="ett.html" />
    
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../">
            
                <a href="../">
            
                    
                    简介
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../intro/roadmap.html">
            
                <a href="../intro/roadmap.html">
            
                    
                    学习路线
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../intro/resources.html">
            
                <a href="../intro/resources.html">
            
                    
                    学习资源
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../intro/common-mistakes.html">
            
                <a href="../intro/common-mistakes.html">
            
                    
                    常见错误
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../intro/common-tricks.html">
            
                <a href="../intro/common-tricks.html">
            
                    
                    常见技巧
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../intro/oi.html">
            
                <a href="../intro/oi.html">
            
                    
                    OI赛事与赛制
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    [语言基础]
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../basic/">
            
                <a href="../basic/">
            
                    
                    算法基础
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../basic/enumerate.html">
            
                <a href="../basic/enumerate.html">
            
                    
                    枚举
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../basic/simulate.html">
            
                <a href="../basic/simulate.html">
            
                    
                    模拟
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../basic/divide-and-conquer.html">
            
                <a href="../basic/divide-and-conquer.html">
            
                    
                    递归&分治
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../basic/sort-intro.html">
            
                <a href="../basic/sort-intro.html">
            
                    
                    排序
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.4.1" data-path="../basic/selection-sort.html">
            
                <a href="../basic/selection-sort.html">
            
                    
                    选择排序
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.2" data-path="../basic/bubble-sort.html">
            
                <a href="../basic/bubble-sort.html">
            
                    
                    冒泡排序
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.3" data-path="../basic/insertion-sort.html">
            
                <a href="../basic/insertion-sort.html">
            
                    
                    插入排序
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.4" data-path="../basic/counting-sort.html">
            
                <a href="../basic/counting-sort.html">
            
                    
                    计数排序
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.5" data-path="../basic/radix-sort.html">
            
                <a href="../basic/radix-sort.html">
            
                    
                    基数排序
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.6" data-path="../basic/quick-sort.html">
            
                <a href="../basic/quick-sort.html">
            
                    
                    快速排序
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.7" data-path="../basic/merge-sort.html">
            
                <a href="../basic/merge-sort.html">
            
                    
                    归并排序
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.8" data-path="../basic/heap-sort.html">
            
                <a href="../basic/heap-sort.html">
            
                    
                    堆排序
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.9" data-path="../basic/bucket-sort.html">
            
                <a href="../basic/bucket-sort.html">
            
                    
                    桶排序
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.10" data-path="../basic/shell-sort.html">
            
                <a href="../basic/shell-sort.html">
            
                    
                    希尔排序
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.11" data-path="../basic/stl-sort.html">
            
                <a href="../basic/stl-sort.html">
            
                    
                    排序相关STL
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.12" data-path="../basic/use-of-sort.html">
            
                <a href="../basic/use-of-sort.html">
            
                    
                    排序应用
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../basic/binary.html">
            
                <a href="../basic/binary.html">
            
                    
                    二分
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../basic/binary-acc.html">
            
                <a href="../basic/binary-acc.html">
            
                    
                    倍增
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="../basic/construction.html">
            
                <a href="../basic/construction.html">
            
                    
                    构造
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8" data-path="../basic/prefix-sum.html">
            
                <a href="../basic/prefix-sum.html">
            
                    
                    前缀&差分
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../search/">
            
                <a href="../search/">
            
                    
                    搜索
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../search/dfs.html">
            
                <a href="../search/dfs.html">
            
                    
                    DFS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../search/bfs.html">
            
                <a href="../search/bfs.html">
            
                    
                    BFS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../search/bidirectional.html">
            
                <a href="../search/bidirectional.html">
            
                    
                    双向搜索
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../search/heuristic.html">
            
                <a href="../search/heuristic.html">
            
                    
                    启发式搜索
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="../search/astar.html">
            
                <a href="../search/astar.html">
            
                    
                    A-star
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6" data-path="../search/iterative.html">
            
                <a href="../search/iterative.html">
            
                    
                    迭代加深搜索
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.7" data-path="../search/idastar.html">
            
                <a href="../search/idastar.html">
            
                    
                    IDA-star
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.8" data-path="../search/backtracking.html">
            
                <a href="../search/backtracking.html">
            
                    
                    回溯
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.9" data-path="../search/dlx.html">
            
                <a href="../search/dlx.html">
            
                    
                    Dancing Links
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.10" data-path="../search/opt.html">
            
                <a href="../search/opt.html">
            
                    
                    优化
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../dp/">
            
                <a href="../dp/">
            
                    
                    动态规划
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../dp/memo.html">
            
                <a href="../dp/memo.html">
            
                    
                    记忆化搜索
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../dp/knapsack.html">
            
                <a href="../dp/knapsack.html">
            
                    
                    背包DP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../dp/interval.html">
            
                <a href="../dp/interval.html">
            
                    
                    区间DP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../dp/dag.html">
            
                <a href="../dp/dag.html">
            
                    
                    DAG上的DP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="../dp/tree.html">
            
                <a href="../dp/tree.html">
            
                    
                    树形DP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6" data-path="../dp/state.html">
            
                <a href="../dp/state.html">
            
                    
                    状压DP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.7" data-path="../dp/number.html">
            
                <a href="../dp/number.html">
            
                    
                    数位DP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.8" data-path="../dp/plug.html">
            
                <a href="../dp/plug.html">
            
                    
                    插头DP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.9" data-path="../dp/count.html">
            
                <a href="../dp/count.html">
            
                    
                    计数DP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.10" data-path="../dp/dynamic.html">
            
                <a href="../dp/dynamic.html">
            
                    
                    动态DP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.11" >
            
                <span>
            
                    
                    [DP优化]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.11.1" data-path="../dp/opt/binary-knapsack.html">
            
                <a href="../dp/opt/binary-knapsack.html">
            
                    
                    二进制分组解多重背包
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.11.2" data-path="../dp/opt/monotonous-queue-stack.html">
            
                <a href="../dp/opt/monotonous-queue-stack.html">
            
                    
                    单调队列/单调栈优化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.11.3" data-path="../dp/opt/slope.html">
            
                <a href="../dp/opt/slope.html">
            
                    
                    斜率优化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.11.4" data-path="../dp/opt/quadrangle.html">
            
                <a href="../dp/opt/quadrangle.html">
            
                    
                    四边形不等式优化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.11.5" data-path="../dp/opt/state.html">
            
                <a href="../dp/opt/state.html">
            
                    
                    状态设计优化
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../string/">
            
                <a href="../string/">
            
                    
                    字符串
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../string/match.html">
            
                <a href="../string/match.html">
            
                    
                    字符串匹配
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../string/hash.html">
            
                <a href="../string/hash.html">
            
                    
                    字符串哈希
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../string/trie.html">
            
                <a href="../string/trie.html">
            
                    
                    字典树Trie
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="../string/kmp.html">
            
                <a href="../string/kmp.html">
            
                    
                    前缀函数&KMP算法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5" data-path="../string/z-func.html">
            
                <a href="../string/z-func.html">
            
                    
                    Z函数(扩展KMP)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.6" data-path="../string/automaton.html">
            
                <a href="../string/automaton.html">
            
                    
                    自动机
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.7" data-path="../string/ac-automaton.html">
            
                <a href="../string/ac-automaton.html">
            
                    
                    AC自动机
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.8" data-path="../string/sa.html">
            
                <a href="../string/sa.html">
            
                    
                    后缀数组(SA)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.9" data-path="../string/sam.html">
            
                <a href="../string/sam.html">
            
                    
                    后缀自动机(SAM)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.10" data-path="../string/general-sam.html">
            
                <a href="../string/general-sam.html">
            
                    
                    广义后缀自动机
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.11" data-path="../string/suffix-tree.html">
            
                <a href="../string/suffix-tree.html">
            
                    
                    后缀树
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.12" data-path="../string/manacher.html">
            
                <a href="../string/manacher.html">
            
                    
                    Manacher
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.13" data-path="../string/pam.html">
            
                <a href="../string/pam.html">
            
                    
                    回文自动机
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.14" data-path="../string/seq-automaton.html">
            
                <a href="../string/seq-automaton.html">
            
                    
                    序列自动机
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.15" data-path="../string/minimal-string.html">
            
                <a href="../string/minimal-string.html">
            
                    
                    最小表示法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.16" data-path="../string/lyndon.html">
            
                <a href="../string/lyndon.html">
            
                    
                    Lyndon分解
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../math/">
            
                <a href="../math/">
            
                    
                    数学
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" >
            
                <span>
            
                    
                    [基础知识]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1.1" data-path="../math/vector.html">
            
                <a href="../math/vector.html">
            
                    
                    向量
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.1.2" data-path="../math/complex.html">
            
                <a href="../math/complex.html">
            
                    
                    复数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.1.3" data-path="../math/polar-coordinate.html">
            
                <a href="../math/polar-coordinate.html">
            
                    
                    极坐标系
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.1.4" data-path="../math/bit.html">
            
                <a href="../math/bit.html">
            
                    
                    位运算
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.1.5" data-path="../math/quick-pow.html">
            
                <a href="../math/quick-pow.html">
            
                    
                    快速幂
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.2" >
            
                <span>
            
                    
                    [数论]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.2.1" data-path="../math/prime.html">
            
                <a href="../math/prime.html">
            
                    
                    素数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.2" data-path="../math/gcd.html">
            
                <a href="../math/gcd.html">
            
                    
                    最大公约数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.3" data-path="../math/euler.html">
            
                <a href="../math/euler.html">
            
                    
                    欧拉函数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.4" data-path="../math/sieve.html">
            
                <a href="../math/sieve.html">
            
                    
                    筛法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.5" data-path="../math/fermat.html">
            
                <a href="../math/fermat.html">
            
                    
                    欧拉定理&费马小定理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.6" data-path="../math/euclidean.html">
            
                <a href="../math/euclidean.html">
            
                    
                    类欧几里得算法
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.3" >
            
                <span>
            
                    
                    [同余与同余方程]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.3.1" data-path="../math/bezouts.html">
            
                <a href="../math/bezouts.html">
            
                    
                    裴属定理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.2" data-path="../math/inverse.html">
            
                <a href="../math/inverse.html">
            
                    
                    乘法逆元
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.3" data-path="../math/linear-equation.html">
            
                <a href="../math/linear-equation.html">
            
                    
                    线性同余方程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.4" data-path="../math/crt.html">
            
                <a href="../math/crt.html">
            
                    
                    中国剩余定理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.5" data-path="../math/bsgs.html">
            
                <a href="../math/bsgs.html">
            
                    
                    BSGS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.6" data-path="../math/primitive-root.html">
            
                <a href="../math/primitive-root.html">
            
                    
                    原根
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.7" data-path="../math/lucas.html">
            
                <a href="../math/lucas.html">
            
                    
                    卢卡斯定理
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="../math/base.html">
            
                <a href="../math/base.html">
            
                    
                    进位制
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5" >
            
                <span>
            
                    
                    [数论函数]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.5.1" data-path="../math/mobius.html">
            
                <a href="../math/mobius.html">
            
                    
                    莫比乌斯反演
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5.2" data-path="../math/du.html">
            
                <a href="../math/du.html">
            
                    
                    杜教筛
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5.3" data-path="../math/min-25.html">
            
                <a href="../math/min-25.html">
            
                    
                    Min-25筛
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.6" data-path="../math/poly/intro.html">
            
                <a href="../math/poly/intro.html">
            
                    
                    多项式
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.6.1" data-path="../math/poly/lagrange.html">
            
                <a href="../math/poly/lagrange.html">
            
                    
                    拉格朗日插值
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.6.2" data-path="../math/poly/fft.html">
            
                <a href="../math/poly/fft.html">
            
                    
                    快速傅里叶变换
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.6.3" data-path="../math/poly/ntt.html">
            
                <a href="../math/poly/ntt.html">
            
                    
                    快速数论变换
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.6.4" data-path="../math/poly/fwt.html">
            
                <a href="../math/poly/fwt.html">
            
                    
                    快速沃尔什变换
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.6.5" data-path="../math/poly/inv.html">
            
                <a href="../math/poly/inv.html">
            
                    
                    多项式求逆
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.6.6" data-path="../math/poly/sqrt.html">
            
                <a href="../math/poly/sqrt.html">
            
                    
                    多项式开方
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.6.7" data-path="../math/poly/div-mod.html">
            
                <a href="../math/poly/div-mod.html">
            
                    
                    多项式对数函数&指数函数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.6.8" data-path="../math/poly/ln-exp.html">
            
                <a href="../math/poly/ln-exp.html">
            
                    
                    多项式牛顿迭代
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.6.9" data-path="../math/poly/newton.html">
            
                <a href="../math/poly/newton.html">
            
                    
                    多项式多点求值&快速插值
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.6.10" data-path="../math/poly/tri-func.html">
            
                <a href="../math/poly/tri-func.html">
            
                    
                    多项式三角函数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.6.11" data-path="../math/poly/inv-tri-func.html">
            
                <a href="../math/poly/inv-tri-func.html">
            
                    
                    多项式反三角函数
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.7" >
            
                <span>
            
                    
                    [线性代数]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.7.1" data-path="../math/matrix.html">
            
                <a href="../math/matrix.html">
            
                    
                    矩阵
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.7.2" data-path="../math/gauss.html">
            
                <a href="../math/gauss.html">
            
                    
                    高斯消元
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.7.3" data-path="../math/basis.html">
            
                <a href="../math/basis.html">
            
                    
                    线性基
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.8" >
            
                <span>
            
                    
                    [抽象代数]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.8.1" data-path="../math/permutation-group.html">
            
                <a href="../math/permutation-group.html">
            
                    
                    置换群
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.9" >
            
                <span>
            
                    
                    [组合数学]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.9.1" data-path="../math/combination.html">
            
                <a href="../math/combination.html">
            
                    
                    排列组合
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.9.2" data-path="../math/catalan.html">
            
                <a href="../math/catalan.html">
            
                    
                    卡特兰数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.9.3" data-path="../math/stirling.html">
            
                <a href="../math/stirling.html">
            
                    
                    斯特林数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.9.4" data-path="../math/cantor.html">
            
                <a href="../math/cantor.html">
            
                    
                    康托展开
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.9.5" data-path="../math/inclusion-exclusion-principle.html">
            
                <a href="../math/inclusion-exclusion-principle.html">
            
                    
                    容斥原理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.9.6" data-path="../math/drawer-principle.html">
            
                <a href="../math/drawer-principle.html">
            
                    
                    抽屉原理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.9.7" data-path="../math/expectation.html">
            
                <a href="../math/expectation.html">
            
                    
                    概率&期望
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.10" data-path="../math/linear-programming.html">
            
                <a href="../math/linear-programming.html">
            
                    
                    线性规划
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.10.1" data-path="../math/simplex.html">
            
                <a href="../math/simplex.html">
            
                    
                    单纯形算法
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.11" data-path="../math/game-theory.html">
            
                <a href="../math/game-theory.html">
            
                    
                    博弈论
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.12" >
            
                <span>
            
                    
                    [常用算法]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.12.1" data-path="../math/newton.html">
            
                <a href="../math/newton.html">
            
                    
                    牛顿迭代法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.12.2" data-path="../math/integral.html">
            
                <a href="../math/integral.html">
            
                    
                    数值积分
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.12.3" data-path="../math/bignum.html">
            
                <a href="../math/bignum.html">
            
                    
                    高精度计算
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.12.4" data-path="../math/dictionary.html">
            
                <a href="../math/dictionary.html">
            
                    
                    分段打表
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.13" data-path="../math/fibonacci.html">
            
                <a href="../math/fibonacci.html">
            
                    
                    斐波那契数列
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="./">
            
                <a href="./">
            
                    
                    数据结构
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="stack.html">
            
                <a href="stack.html">
            
                    
                    栈
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="queue.html">
            
                <a href="queue.html">
            
                    
                    队列
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="linked-list.html">
            
                <a href="linked-list.html">
            
                    
                    链表
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.4" data-path="hash.html">
            
                <a href="hash.html">
            
                    
                    哈希表
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.5" data-path="dsu.html">
            
                <a href="dsu.html">
            
                    
                    并查集
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.6" data-path="heap.html">
            
                <a href="heap.html">
            
                    
                    堆
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.6.1" data-path="binary-heap.html">
            
                <a href="binary-heap.html">
            
                    
                    二叉堆
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.6.2" data-path="pairing-heap.html">
            
                <a href="pairing-heap.html">
            
                    
                    配对堆
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.6.3" data-path="leftist-tree.html">
            
                <a href="leftist-tree.html">
            
                    
                    左偏树
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9.7" >
            
                <span>
            
                    
                    [块状数据结构]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.7.1" data-path="decompose.html">
            
                <a href="decompose.html">
            
                    
                    分块思想
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.7.2" data-path="tree-decompose.html">
            
                <a href="tree-decompose.html">
            
                    
                    树分块
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.7.3" data-path="block-list.html">
            
                <a href="block-list.html">
            
                    
                    块状链表
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.7.4" data-path="block-array.html">
            
                <a href="block-array.html">
            
                    
                    块状数组
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.7.5" data-path="sqrt-tree.html">
            
                <a href="sqrt-tree.html">
            
                    
                    sqrt tree
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9.8" data-path="monotonous-stack.html">
            
                <a href="monotonous-stack.html">
            
                    
                    单调栈
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.9" data-path="monotonous-queue.html">
            
                <a href="monotonous-queue.html">
            
                    
                    单调队列
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.10" data-path="sparse-table.html">
            
                <a href="sparse-table.html">
            
                    
                    ST表
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.11" data-path="bit.html">
            
                <a href="bit.html">
            
                    
                    树状数组
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.12" data-path="seg.html">
            
                <a href="seg.html">
            
                    
                    线段树
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.13" data-path="seg-beats.html">
            
                <a href="seg-beats.html">
            
                    
                    区间最值操作&区间历史最值
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.14" data-path="dividing.html">
            
                <a href="dividing.html">
            
                    
                    划分树
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.15" data-path="bst.html">
            
                <a href="bst.html">
            
                    
                    二叉搜索树&平衡树
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.15.1" data-path="treap.html">
            
                <a href="treap.html">
            
                    
                    Treap
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.15.2" data-path="splay.html">
            
                <a href="splay.html">
            
                    
                    Splay
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.15.3" data-path="wblt.html">
            
                <a href="wblt.html">
            
                    
                    WBLT
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.15.4" data-path="sbt.html">
            
                <a href="sbt.html">
            
                    
                    Size Balanced Tree
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.15.5" data-path="avl.html">
            
                <a href="avl.html">
            
                    
                    AVL树
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.15.6" data-path="sgt.html">
            
                <a href="sgt.html">
            
                    
                    替罪羊树
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.15.7" data-path="cartesian-tree.html">
            
                <a href="cartesian-tree.html">
            
                    
                    笛卡尔树
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9.16" data-path="persistent.html">
            
                <a href="persistent.html">
            
                    
                    可持久化数据结构
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.16.1" data-path="persistent-seg.html">
            
                <a href="persistent-seg.html">
            
                    
                    可持久化线段树
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.16.2" data-path="persistent-block-array.html">
            
                <a href="persistent-block-array.html">
            
                    
                    可持久化块状数组
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.16.3" data-path="persistent-balanced.html">
            
                <a href="persistent-balanced.html">
            
                    
                    可持久化平衡树
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.16.4" data-path="persistent-trie.html">
            
                <a href="persistent-trie.html">
            
                    
                    可持久化字典树
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.16.5" data-path="persistent-in-bit.html">
            
                <a href="persistent-in-bit.html">
            
                    
                    可持久化可并堆
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.16.6" data-path="persistent-heap.html">
            
                <a href="persistent-heap.html">
            
                    
                    可持久化左偏树
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9.17" >
            
                <span>
            
                    
                    [树套树]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.17.1" data-path="seg-in-seg.html">
            
                <a href="seg-in-seg.html">
            
                    
                    线段树套线段树
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.17.2" data-path="seg-in-balanced.html">
            
                <a href="seg-in-balanced.html">
            
                    
                    平衡树套线段树
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.17.3" data-path="balanced-in-seg.html">
            
                <a href="balanced-in-seg.html">
            
                    
                    线段树套平衡树
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.17.4" data-path="persistent-in-bit.html">
            
                <a href="persistent-in-bit.html">
            
                    
                    树状数组套主席树
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9.18" data-path="kdt.html">
            
                <a href="kdt.html">
            
                    
                    K-D Tree
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.19" data-path="odt.html">
            
                <a href="odt.html">
            
                    
                    珂朵莉树
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.20" >
            
                <span>
            
                    
                    [动态树]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.9.20.1" data-path="lct.html">
            
                <a href="lct.html">
            
                    
                    Link Cut Tree
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.20.2" data-path="ett.html">
            
                <a href="ett.html">
            
                    
                    Euler Tour Tree
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.20.3" data-path="top-tree.html">
            
                <a href="top-tree.html">
            
                    
                    Top Tree
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9.21" data-path="divide-combine.html">
            
                <a href="divide-combine.html">
            
                    
                    析合树
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../graph/">
            
                <a href="../graph/">
            
                    
                    图论
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../graph/basic.html">
            
                <a href="../graph/basic.html">
            
                    
                    图论基础
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="../graph/dfs.html">
            
                <a href="../graph/dfs.html">
            
                    
                    DFS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.3" data-path="../graph/bfs.html">
            
                <a href="../graph/bfs.html">
            
                    
                    BFS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.4" >
            
                <span>
            
                    
                    [树上问题]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.4.1" data-path="../graph/tree-basic.html">
            
                <a href="../graph/tree-basic.html">
            
                    
                    树基础
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.4.2" data-path="../graph/lca.html">
            
                <a href="../graph/lca.html">
            
                    
                    最近公共祖先
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.4.3" data-path="../graph/tree-misc.html">
            
                <a href="../graph/tree-misc.html">
            
                    
                    树的其他问题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.4.4" data-path="../graph/tree-hash.html">
            
                <a href="../graph/tree-hash.html">
            
                    
                    树哈希
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.4.5" data-path="../graph/hld.html">
            
                <a href="../graph/hld.html">
            
                    
                    树链剖分
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.4.6" data-path="../graph/tree-divide.html">
            
                <a href="../graph/tree-divide.html">
            
                    
                    树分治
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.4.7" data-path="../graph/dynamic-tree-divide.html">
            
                <a href="../graph/dynamic-tree-divide.html">
            
                    
                    动态树分治
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.4.8" data-path="../graph/virtual-tree.html">
            
                <a href="../graph/virtual-tree.html">
            
                    
                    虚树
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.4.9" data-path="../graph/dsu-on-tree.html">
            
                <a href="../graph/dsu-on-tree.html">
            
                    
                    树上启发式合并
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10.5" data-path="../graph/matrix-tree.html">
            
                <a href="../graph/matrix-tree.html">
            
                    
                    矩阵树定理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.6" data-path="../graph/dag.html">
            
                <a href="../graph/dag.html">
            
                    
                    有向无环图
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.7" data-path="../graph/topo.html">
            
                <a href="../graph/topo.html">
            
                    
                    拓扑排序
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.8" data-path="../graph/mst.html">
            
                <a href="../graph/mst.html">
            
                    
                    最小生成树
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.9" data-path="../graph/mdst.html">
            
                <a href="../graph/mdst.html">
            
                    
                    最小树形图
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.10" data-path="../graph/shortest-path.html">
            
                <a href="../graph/shortest-path.html">
            
                    
                    最短路
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.11" data-path="../graph/node.html">
            
                <a href="../graph/node.html">
            
                    
                    拆点
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.12" data-path="../graph/diff-constraints.html">
            
                <a href="../graph/diff-constraints.html">
            
                    
                    差分约束
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.13" data-path="../graph/kth-path.html">
            
                <a href="../graph/kth-path.html">
            
                    
                    k短路
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.14" >
            
                <span>
            
                    
                    [连通性相关]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.14.1" data-path="../graph/scc.html">
            
                <a href="../graph/scc.html">
            
                    
                    强连通分量
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.14.2" data-path="../graph/bcc.html">
            
                <a href="../graph/bcc.html">
            
                    
                    双联通分量
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.14.3" data-path="../graph/bridge.html">
            
                <a href="../graph/bridge.html">
            
                    
                    割点和桥
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.14.4" data-path="../graph/2-sat.html">
            
                <a href="../graph/2-sat.html">
            
                    
                    2-SAT
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10.15" data-path="../graph/euler.html">
            
                <a href="../graph/euler.html">
            
                    
                    欧拉图
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.16" data-path="../graph/hamilton.html">
            
                <a href="../graph/hamilton.html">
            
                    
                    哈密顿图
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.17" data-path="../graph/bi-graph.html">
            
                <a href="../graph/bi-graph.html">
            
                    
                    二分图
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.18" data-path="../graph/min-circle.html">
            
                <a href="../graph/min-circle.html">
            
                    
                    最小环
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.19" data-path="../graph/planar.html">
            
                <a href="../graph/planar.html">
            
                    
                    平面图
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.20" data-path="../graph/color.html">
            
                <a href="../graph/color.html">
            
                    
                    图的着色
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.21" data-path="../graph/flow.html">
            
                <a href="../graph/flow.html">
            
                    
                    网络流
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.21.1" data-path="../graph/flow/max-flow.html">
            
                <a href="../graph/flow/max-flow.html">
            
                    
                    最大流
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.21.2" data-path="../graph/flow/min-cut.html">
            
                <a href="../graph/flow/min-cut.html">
            
                    
                    最小割
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.21.3" data-path="../graph/flow/min-cost.html">
            
                <a href="../graph/flow/min-cost.html">
            
                    
                    费用流
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.21.4" data-path="../graph/flow/bound.html">
            
                <a href="../graph/flow/bound.html">
            
                    
                    上下界网络流
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10.22" data-path="../graph/prufer.html">
            
                <a href="../graph/prufer.html">
            
                    
                    Prufer序列
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.23" data-path="../graph/lgv.html">
            
                <a href="../graph/lgv.html">
            
                    
                    LGV引理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.24" data-path="../graph/misc.html">
            
                <a href="../graph/misc.html">
            
                    
                    图论杂项
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../geometry/">
            
                <a href="../geometry/">
            
                    
                    计算几何
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="../geometry/2d.html">
            
                <a href="../geometry/2d.html">
            
                    
                    二维计算几何
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2" data-path="../geometry/3d.html">
            
                <a href="../geometry/3d.html">
            
                    
                    三维计算几何
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.3" data-path="../geometry/distance.html">
            
                <a href="../geometry/distance.html">
            
                    
                    距离
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.4" data-path="../geometry/pick.html">
            
                <a href="../geometry/pick.html">
            
                    
                    Pick定理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.5" data-path="../geometry/triangulation.html">
            
                <a href="../geometry/triangulation.html">
            
                    
                    三角剖分
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.6" data-path="../geometry/convex-hull.html">
            
                <a href="../geometry/convex-hull.html">
            
                    
                    凸包
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.7" data-path="../geometry/scanning.html">
            
                <a href="../geometry/scanning.html">
            
                    
                    扫描线
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.8" data-path="../geometry/rotating-calipers.html">
            
                <a href="../geometry/rotating-calipers.html">
            
                    
                    旋转卡壳
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.9" data-path="../geometry/half-plane.html">
            
                <a href="../geometry/half-plane.html">
            
                    
                    半平面交
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.10" data-path="../geometry/nearest-points.html">
            
                <a href="../geometry/nearest-points.html">
            
                    
                    平面最近点对
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.11" data-path="../geometry/random-incremental.html">
            
                <a href="../geometry/random-incremental.html">
            
                    
                    随机增量法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.12" data-path="../geometry/inverse.html">
            
                <a href="../geometry/inverse.html">
            
                    
                    反演变换
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.13" data-path="../geometry/misc.html">
            
                <a href="../geometry/misc.html">
            
                    
                    计算几何杂项
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../misc/">
            
                <a href="../misc/">
            
                    
                    杂项
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="../misc/discrete.html">
            
                <a href="../misc/discrete.html">
            
                    
                    离散化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2" data-path="../misc/offline.html">
            
                <a href="../misc/offline.html">
            
                    
                    离线算法
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.2.1" data-path="../misc/cdq-divide.html">
            
                <a href="../misc/cdq-divide.html">
            
                    
                    CDQ分治
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2.2" data-path="../misc/parallel-binsearch.html">
            
                <a href="../misc/parallel-binsearch.html">
            
                    
                    整体二分
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2.3" data-path="../misc/mo-algo.html">
            
                <a href="../misc/mo-algo.html">
            
                    
                    莫队算法
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.3" >
            
                <span>
            
                    
                    [随机化]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.3.1" data-path="../misc/random.html">
            
                <a href="../misc/random.html">
            
                    
                    随机函数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3.2" data-path="../misc/hill-climbing.html">
            
                <a href="../misc/hill-climbing.html">
            
                    
                    爬山算法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3.3" data-path="../misc/simulated-annealing.html">
            
                <a href="../misc/simulated-annealing.html">
            
                    
                    模拟退火
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12.4" data-path="../misc/largest-matrix.html">
            
                <a href="../misc/largest-matrix.html">
            
                    
                    悬线法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5" data-path="../misc/cc-basic.html">
            
                <a href="../misc/cc-basic.html">
            
                    
                    计算理论基础
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.6" data-path="../misc/josephus.html">
            
                <a href="../misc/josephus.html">
            
                    
                    约瑟夫问题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7" data-path="../misc/expression.html">
            
                <a href="../misc/expression.html">
            
                    
                    表达式求值
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.13" >
            
                <span>
            
                    
                    [专题]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.1" data-path="../topic/rmq.html">
            
                <a href="../topic/rmq.html">
            
                    
                    RMQ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.2" data-path="../topic/problemsetting.html">
            
                <a href="../topic/problemsetting.html">
            
                    
                    出题
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Link Cut Tree</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="&#x7B80;&#x4ECB;">&#x7B80;&#x4ECB;</h2>
<ol>
<li>Link/Cut Tree &#x662F;&#x4E00;&#x79CD;&#x6570;&#x636E;&#x7ED3;&#x6784;&#xFF0C;&#x6211;&#x4EEC;&#x7528;&#x5B83;&#x6765;&#x89E3;&#x51B3;<font color="red">&#x52A8;&#x6001;&#x6811;&#x95EE;&#x9898;</font>&#x3002;</li>
<li>Link/Cut Tree &#x53C8;&#x79F0; Link-Cut Tree&#xFF0C;&#x7B80;&#x79F0; LCT, &#x4F46;&#x5B83;&#x4E0D;&#x53EB;&#x52A8;&#x6001;&#x6811;&#xFF0C;&#x52A8;&#x6001;&#x6811;&#x662F;&#x6307;&#x4E00;&#x7C7B;&#x95EE;&#x9898;&#x3002;</li>
<li>Splay Tree &#x662F; LCT &#x7684;&#x57FA;&#x7840;&#xFF0C;&#x4F46;&#x662F; LCT &#x2F64;&#x7684; Splay Tree &#x548C;&#x666E;&#x901A;&#x7684; Splay &#x5728;&#x7EC6;&#x8282;&#x5904;&#x4E0D;&#x592A;&#x4E00;&#x6837;&#xFF08;&#x8FDB;&#x884C;&#x4E86;&#x4E00;&#x4E9B;&#x6269;&#x5C55;&#xFF09;&#x3002;</li>
<li>&#x8FD9;&#x662F;&#x2F00;&#x4E2A;&#x548C; Splay &#x2F00;&#x6837;&#x53EA;&#x9700;&#x8981;&#x5199;&#x2F0F; (yi) &#x4E2A; (dui) &#x6838;&#x5FC3;&#x51FD;&#x6570;&#x5C31;&#x80FD;&#x5B9E;&#x73B0;&#x4E00;&#x5207;&#x7684;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x3002;</li>
</ol>
<h2 id="&#x95EE;&#x9898;&#x5F15;&#x5165;">&#x95EE;&#x9898;&#x5F15;&#x5165;</h2>
<ul>
<li>&#x7EF4;&#x62A4;&#x4E00;&#x68F5;&#x6811;&#xFF0C;&#x652F;&#x6301;&#x5982;&#x4E0B;&#x64CD;&#x4F5C;&#x3002;</li>
<li>&#x4FEE;&#x6539;&#x4E24;&#x70B9;&#x95F4;&#x8DEF;&#x5F84;&#x6743;&#x503C;&#x3002;</li>
<li>&#x67E5;&#x8BE2;&#x4E24;&#x70B9;&#x95F4;&#x8DEF;&#x5F84;&#x6743;&#x503C;&#x548C;&#x3002;</li>
<li>&#x4FEE;&#x6539;&#x67D0;&#x70B9;&#x5B50;&#x6811;&#x6743;&#x503C;&#x3002;</li>
<li>&#x67E5;&#x8BE2;&#x67D0;&#x70B9;&#x5B50;&#x6811;&#x6743;&#x503C;&#x548C;&#x3002;
  &#x5514;&#xFF0C;&#x770B;&#x4E0A;&#x53BB;&#x662F;&#x4E00;&#x9053;&#x6811;&#x5256;&#x6A21;&#x7248;&#x9898;&#x3002;</li>
</ul>
<p>&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x52A0;&#x4E00;&#x4E2A;&#x64CD;&#x4F5C;</p>
<ul>
<li>&#x65AD;&#x5F00;&#x5E76;&#x8FDE;&#x63A5;&#x4E00;&#x4E9B;&#x8FB9;&#xFF0C;&#x4FDD;&#x8BC1;&#x4ECD;&#x662F;&#x4E00;&#x68F5;&#x6811;&#x3002;</li>
</ul>
<p>&#x8981;&#x6C42;&#x5728;&#x7EBF;&#x6C42;&#x51FA;&#x4E0A;&#x9762;&#x7684;&#x7B54;&#x6848;&#x3002;</p>
<p>&#x2014;&#x2014;&#x52A8;&#x6001;&#x6811;&#x95EE;&#x9898;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6CD5;&#xFF1A;Link/Cut Tree!</p>
<h2 id="&#x52A8;&#x6001;&#x6811;&#x95EE;&#x9898;">&#x52A8;&#x6001;&#x6811;&#x95EE;&#x9898;</h2>
<ul>
<li><p>&#x7EF4;&#x62A4;&#x4E00;&#x4E2A;<font color="red">&#x68EE;&#x6797;</font>, &#x652F;&#x6301;&#x5220;&#x9664;&#x67D0;&#x6761;&#x8FB9;&#xFF0C;&#x52A0;&#x2F0A;&#x67D0;&#x6761;&#x8FB9;&#xFF0C;&#x5E76;&#x4FDD;&#x8BC1;&#x52A0;&#x8FB9;&#xFF0C;&#x5220;&#x8FB9;&#x4E4B;&#x540E;&#x4ECD;&#x662F;&#x68EE;&#x6797;&#x3002;&#x6211;&#x4EEC;&#x8981;&#x7EF4;&#x62A4;&#x8FD9;&#x4E2A;&#x68EE;&#x6797;&#x7684;&#x4E00;&#x4E9B;&#x4FE1;&#x606F;&#x3002;</p>
</li>
<li><p>&#x4E00;&#x822C;&#x7684;&#x64CD;&#x4F5C;&#x6709;&#x4E24;&#x70B9;&#x8FDE;&#x901A;&#x6027;&#xFF0C;&#x4E24;&#x70B9;&#x8DEF;&#x5F84;&#x6743;&#x503C;&#x548C;&#xFF0C;&#x8FDE;&#x63A5;&#x4E24;&#x70B9;&#x548C;&#x5207;&#x65AD;&#x67D0;&#x6761;&#x8FB9;&#x3001;&#x4FEE;&#x6539;&#x4FE1;&#x606F;&#x7B49;&#x3002;</p>
</li>
</ul>
<hr>
<h3 id="&#x4ECE;-lct-&#x7684;&#x89D2;&#x5EA6;&#x56DE;&#x987E;&#x4E00;&#x4E0B;&#x6811;&#x94FE;&#x5256;&#x5206;">&#x4ECE; LCT &#x7684;&#x89D2;&#x5EA6;&#x56DE;&#x987E;&#x4E00;&#x4E0B;&#x6811;&#x94FE;&#x5256;&#x5206;</h3>
<ul>
<li><p>&#x5BF9;&#x6574;&#x68F5;&#x6811;&#x6309;&#x5B50;&#x6811;&#x2F24;&#x5C0F;&#x8FDB;&#x2F8F;&#x5256;&#x5206;&#xFF0C;&#x5E76;&#x91CD;&#x65B0;&#x6807;&#x53F7;&#x3002;</p>
</li>
<li><p>&#x6211;&#x4EEC;&#x53D1;&#x73B0;&#x91CD;&#x65B0;&#x6807;&#x53F7;&#x4E4B;&#x540E;&#xFF0C;&#x5728;&#x6811;&#x4E0A;&#x5F62;&#x6210;&#x4E86;&#x4E00;&#x4E9B;&#x4EE5;&#x94FE;&#x4E3A;&#x5355;&#x4F4D;&#x7684;&#x8FDE;&#x7EED;&#x533A;&#x95F4;&#xFF0C;&#x5E76;&#x4E14;&#x53EF;&#x4EE5;&#x7528;&#x7EBF;&#x6BB5;&#x6811;&#x8FDB;&#x2F8F;&#x533A;&#x95F4;&#x64CD;&#x4F5C;&#x3002;</p>
</li>
</ul>
<h3 id="&#x8F6C;&#x5411;&#x52A8;&#x6001;&#x6811;&#x95EE;&#x9898;">&#x8F6C;&#x5411;&#x52A8;&#x6001;&#x6811;&#x95EE;&#x9898;</h3>
<ul>
<li><p>&#x6211;&#x4EEC;&#x53D1;&#x73B0;&#x6211;&#x4EEC;&#x521A;&#x521A;&#x8BB2;&#x7684;&#x6811;&#x5256;&#x662F;&#x4EE5;&#x5B50;&#x6811;&#x2F24;&#x5C0F;&#x4F5C;&#x4E3A;&#x5212;&#x5206;&#x6761;&#x4EF6;&#x3002;</p>
</li>
<li><p>&#x90A3;&#x6211;&#x4EEC;&#x80FD;&#x4E0D;&#x80FD;&#x91CD;&#x5B9A;&#x4E49;&#x4E00;&#x79CD;&#x5256;&#x5206;&#xFF0C;&#x4F7F;&#x5B83;&#x66F4;&#x9002;&#x5E94;&#x6211;&#x4EEC;&#x7684;&#x52A8;&#x6001;&#x6811;&#x95EE;&#x9898;&#x5462;&#xFF1F;</p>
</li>
<li><p>&#x8003;&#x8651;&#x52A8;&#x6001;&#x6811;&#x95EE;&#x9898;&#x9700;&#x8981;&#x4EC0;&#x4E48;&#x94FE;&#x3002;</p>
</li>
<li><p>&#x7531;&#x4E8E;&#x52A8;&#x6001;&#x7EF4;&#x62A4;&#x2F00;&#x4E2A;&#x68EE;&#x6797;&#xFF0C;&#x663E;&#x7136;&#x6211;&#x4EEC;&#x5E0C;&#x671B;&#x8FD9;&#x4E2A;&#x94FE;&#x662F;&#x6211;&#x4EEC;&#x6307;&#x5B9A;&#x7684;&#x94FE;&#xFF0C;&#x4EE5;&#x4FBF;&#x5229;&#x2F64;&#x6765;&#x6C42;&#x89E3;&#x3002;</p>
</li>
</ul>
<h2 id="&#x5B9E;&#x94FE;&#x5256;&#x5206;"><font color="red">&#x5B9E;&#x94FE;&#x5256;&#x5206;</font></h2>
<ul>
<li><p>&#x5BF9;&#x4E8E;&#x2F00;&#x4E2A;&#x70B9;&#x8FDE;&#x5411;&#x5B83;&#x6240;&#x6709;&#x2F09;&#x5B50;&#x7684;&#x8FB9; , &#x6211;&#x4EEC;&#x2F83;&#x5DF1;&#x9009;&#x62E9;&#x2F00;&#x6761;&#x8FB9;&#x8FDB;&#x884C;&#x5256;&#x5206;&#xFF0C;&#x6211;&#x4EEC;&#x79F0;&#x88AB;&#x9009;&#x62E9;&#x7684;&#x8FB9;&#x4E3A;&#x5B9E;&#x8FB9;&#xFF0C;&#x5176;&#x4ED6;&#x8FB9;&#x5219;&#x4E3A;&#x865A;&#x8FB9;&#x3002;</p>
</li>
<li><p>&#x5BF9;&#x4E8E;&#x5B9E;&#x8FB9;&#xFF0C;&#x6211;&#x4EEC;&#x79F0;&#x5B83;&#x6240;&#x8FDE;&#x63A5;&#x7684;&#x2F09;&#x5B50;&#x4E3A;&#x5B9E;&#x2F09;&#x5B50;&#x3002;</p>
</li>
<li><p>&#x5BF9;&#x4E8E;&#x2F00;&#x6761;&#x7531;&#x5B9E;&#x8FB9;&#x7EC4;&#x6210;&#x7684;&#x94FE;&#xFF0C;&#x6211;&#x4EEC;&#x540C;&#x6837;&#x79F0;&#x4E4B;&#x4E3A;&#x5B9E;&#x94FE;&#x3002;</p>
</li>
<li><p>&#x8BF7;&#x8BB0;&#x4F4F;&#x6211;&#x4EEC;&#x9009;&#x62E9;&#x5B9E;&#x94FE;&#x5256;&#x5206;&#x7684;&#x6700;&#x91CD;&#x8981;&#x7684;&#x539F;&#x56E0;&#xFF1A;&#x5B83;&#x662F;&#x6211;&#x4EEC;&#x9009;&#x62E9;&#x7684;&#xFF0C;&#x7075;&#x6D3B;&#x4E14;&#x53EF;&#x53D8;&#x3002;</p>
</li>
<li><p>&#x6B63;&#x662F;&#x5B83;&#x7684;&#x8FD9;&#x79CD;&#x7075;&#x6D3B;&#x53EF;&#x53D8;&#x6027;&#xFF0C;&#x6211;&#x4EEC;&#x91C7;&#x7528; Splay Tree &#x6765;&#x7EF4;&#x62A4;&#x8FD9;&#x4E9B;&#x5B9E;&#x94FE;&#x3002;</p>
</li>
</ul>
<h2 id="lct&#xFF01;">LCT&#xFF01;</h2>
<ul>
<li><p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x7B80;&#x5355;&#x7684;&#x628A; LCT &#x7406;&#x89E3;&#x6210;&#x7528;&#x2F00;&#x4E9B; Splay &#x6765;&#x7EF4;&#x62A4;&#x52A8;&#x6001;&#x7684;&#x6811;&#x94FE;&#x5256;&#x5206;&#xFF0C;&#x4EE5;&#x671F;&#x5B9E;&#x73B0;&#x52A8;&#x6001;&#x6811;&#x4E0A;&#x7684;&#x533A;&#x95F4;&#x64CD;&#x4F5C;&#x3002;</p>
</li>
<li><p>&#x5BF9;&#x4E8E;&#x6BCF;&#x6761;&#x5B9E;&#x94FE;&#xFF0C;&#x6211;&#x4EEC;&#x5EFA;&#x2F00;&#x4E2A; Splay &#x6765;&#x7EF4;&#x62A4;&#x6574;&#x4E2A;&#x94FE;&#x533A;&#x95F4;&#x7684;&#x4FE1;&#x606F;&#x3002;</p>
</li>
<li><p>&#x63A5;&#x4E0B;&#x6765;&#xFF0C;&#x6211;&#x4EEC;&#x6765;&#x5B66;&#x4E60; LCT &#x7684;&#x5177;&#x4F53;&#x7ED3;&#x6784;&#x3002;</p>
</li>
</ul>
<h2 id="-&#x8F85;&#x52A9;&#x6811;">- &#x8F85;&#x52A9;&#x6811;</h2>
<ul>
<li><p>&#x6211;&#x4EEC;&#x5148;&#x6765;&#x770B;&#x2F00;&#x770B;&#x8F85;&#x52A9;&#x6811;&#x7684;&#x4E00;&#x4E9B;&#x6027;&#x8D28;&#xFF0C;&#x518D;&#x901A;&#x8FC7;&#x4E00;&#x5F20;&#x56FE;&#x5B9E;&#x9645;&#x4E86;&#x89E3;&#x4E00;&#x4E0B;&#x8F85;&#x52A9;&#x6811;&#x7684;&#x5177;&#x4F53;&#x7ED3;&#x6784;&#x3002;</p>
</li>
<li><p>&#x5728;&#x672C;&#x6587;&#x91CC;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x8BA4;&#x4E3A;&#x4E00;&#x4E9B; Splay &#x6784;&#x6210;&#x4E86;&#x4E00;&#x4E2A;&#x8F85;&#x52A9;&#x6811;&#xFF0C;&#x6BCF;&#x68F5;&#x8F85;&#x52A9;&#x6811;&#x7EF4;&#x62A4;&#x7684;&#x662F;&#x4E00;&#x68F5;&#x6811;&#xFF0C;&#x4E00;&#x4E9B;&#x8F85;&#x52A9;&#x6811;&#x6784;&#x6210;&#x4E86; LCT&#xFF0C;&#x5176;&#x7EF4;&#x62A4;&#x7684;&#x662F;&#x6574;&#x4E2A;&#x68EE;&#x6797;&#x3002;</p>
</li>
<li><p>&#x8F85;&#x52A9;&#x6811;&#x7531;&#x591A;&#x68F5; Splay &#x7EC4;&#x6210;&#xFF0C;&#x6BCF;&#x68F5; Splay &#x7EF4;&#x62A4;&#x539F;&#x6811;&#x4E2D;&#x7684;&#x4E00;&#x6761;&#x8DEF;&#x5F84;&#xFF0C;&#x4E14;&#x4E2D;&#x5E8F;&#x904D;&#x5386;&#x8FD9;&#x68F5; Splay &#x5F97;&#x5230;&#x7684;&#x70B9;&#x5E8F;&#x5217;&#xFF0C;&#x4ECE;&#x524D;&#x5230;&#x540E;&#x5BF9;&#x5E94;&#x539F;&#x6811;&#x201C;&#x4ECE;&#x4E0A;&#x5230;&#x4E0B;&#x201D;&#x7684;&#x4E00;&#x6761;&#x8DEF;&#x5F84;&#x3002;</p>
</li>
<li>&#x539F;&#x6811;&#x6BCF;&#x4E2A;&#x8282;&#x70B9;&#x4E0E;&#x8F85;&#x52A9;&#x6811;&#x7684; Splay &#x8282;&#x70B9;&#x4E00;&#x4E00;&#x5BF9;&#x5E94;&#x3002;</li>
<li>&#x8F85;&#x52A9;&#x6811;&#x7684;&#x5404;&#x68F5; Splay &#x4E4B;&#x95F4;&#x5E76;&#x4E0D;&#x662F;&#x72EC;&#x7ACB;&#x7684;&#x3002;&#x6BCF;&#x68F5; Splay &#x7684;&#x6839;&#x8282;&#x70B9;&#x7684;&#x7236;&#x4EB2;&#x8282;&#x70B9;&#x672C;&#x5E94;&#x662F;&#x7A7A;&#xFF0C;&#x4F46;&#x5728; LCT &#x4E2D;&#x6BCF;&#x68F5; Splay &#x7684;&#x6839;&#x8282;&#x70B9;&#x7684;&#x7236;&#x4EB2;&#x8282;&#x70B9;&#x6307;&#x5411;&#x539F;&#x6811;&#x4E2D; <strong>&#x8FD9;&#x6761;&#x94FE;</strong> &#x7684;&#x7236;&#x4EB2;&#x8282;&#x70B9;&#xFF08;&#x5373;&#x94FE;&#x6700;&#x9876;&#x7AEF;&#x7684;&#x70B9;&#x7684;&#x7236;&#x4EB2;&#x8282;&#x70B9;&#xFF09;&#x3002;&#x8FD9;&#x7C7B;&#x7236;&#x4EB2;&#x94FE;&#x63A5;&#x4E0E;&#x901A;&#x5E38; Splay &#x7684;&#x7236;&#x4EB2;&#x94FE;&#x63A5;&#x533A;&#x522B;&#x5728;&#x4E8E;&#x513F;&#x5B50;&#x8BA4;&#x7236;&#x4EB2;&#xFF0C;&#x800C;&#x7236;&#x4EB2;&#x4E0D;&#x8BA4;&#x513F;&#x5B50;&#xFF0C;&#x5BF9;&#x5E94;&#x539F;&#x6811;&#x7684;&#x4E00;&#x6761; <strong>&#x865A;&#x8FB9;</strong> &#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x6BCF;&#x4E2A;&#x8054;&#x901A;&#x5757;&#x6070;&#x597D;&#x6709;&#x4E00;&#x4E2A;&#x70B9;&#x7684;&#x7236;&#x4EB2;&#x8282;&#x70B9;&#x4E3A;&#x7A7A;&#x3002;</li>
<li><p>&#x7531;&#x4E8E;&#x8F85;&#x52A9;&#x6811;&#x7684;&#x4EE5;&#x4E0A;&#x6027;&#x8D28;&#xFF0C;&#x6211;&#x4EEC;&#x7EF4;&#x62A4;&#x4EFB;&#x4F55;&#x64CD;&#x4F5C;&#x90FD;&#x4E0D;&#x9700;&#x8981;&#x7EF4;&#x62A4;&#x539F;&#x6811;&#xFF0C;&#x8F85;&#x52A9;&#x6811;&#x53EF;&#x4EE5;&#x5728;&#x4EFB;&#x4F55;&#x60C5;&#x51B5;&#x4E0B;&#x62FF;&#x51FA;&#x4E00;&#x4E2A;&#x552F;&#x4E00;&#x7684;&#x539F;&#x6811;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;&#x7EF4;&#x62A4;&#x8F85;&#x52A9;&#x6811;&#x5373;&#x53EF;&#x3002;&#xFF08;&#x672C;&#x53E5;&#x6765;&#x6E90;&#x81EA; @PoPoQQQ &#x5927;&#x7237;&#x7684; PPT)</p>
</li>
<li><p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x6709;&#x2F00;&#x68F5;&#x539F;&#x6811;&#xFF0C;&#x5982;&#x56FE;&#x3002;</p>
</li>
<li>&#x52A0;&#x7C97;&#x8FB9;&#x662F;&#x5B9E;&#x8FB9;&#xFF0C;&#x865A;&#x7EBF;&#x8FB9;&#x662F;&#x865A;&#x8FB9;&#x3002;</li>
</ul>
<p><img src="images/lct9.png" alt="lct9"></p>
<ul>
<li>&#x7531;&#x521A;&#x521A;&#x7684;&#x5B9A;&#x4E49;&#xFF0C;&#x8F85;&#x52A9;&#x6811;&#x7684;&#x7ED3;&#x6784;&#x5982;&#x4E0B;</li>
</ul>
<p><img src="images/lct10.png" alt="lct10"></p>
<h3 id="&#x8003;&#x8651;&#x539F;&#x6811;&#x548C;&#x8F85;&#x52A9;&#x6811;&#x7684;&#x7ED3;&#x6784;&#x5173;&#x7CFB;">&#x8003;&#x8651;&#x539F;&#x6811;&#x548C;&#x8F85;&#x52A9;&#x6811;&#x7684;&#x7ED3;&#x6784;&#x5173;&#x7CFB;</h3>
<ul>
<li><p>&#x539F;&#x6811;&#x4E2D;&#x7684;&#x5B9E;&#x94FE; : &#x5728;&#x8F85;&#x52A9;&#x6811;&#x4E2D;&#x8282;&#x70B9;&#x90FD;&#x5728;&#x4E00;&#x68F5; Splay &#x4E2D;&#x3002;</p>
</li>
<li><p>&#x539F;&#x6811;&#x4E2D;&#x7684;&#x865A;&#x94FE; : &#x5728;&#x8F85;&#x52A9;&#x6811;&#x4E2D;&#xFF0C;&#x5B50;&#x8282;&#x70B9;&#x6240;&#x5728; Splay &#x7684; Father &#x6307;&#x5411;&#x7236;&#x8282;&#x70B9;&#xFF0C;&#x4F46;&#x662F;&#x7236;&#x8282;&#x70B9;&#x7684;&#x4E24;&#x4E2A;&#x513F;&#x5B50;&#x90FD;&#x4E0D;&#x6307;&#x5411;&#x5B50;&#x8282;&#x70B9;&#x3002;</p>
</li>
<li><p>&#x6CE8;&#x610F;&#xFF1A;&#x539F;&#x6811;&#x7684;&#x6839;&#x4E0D;&#x7B49;&#x4E8E;&#x8F85;&#x52A9;&#x6811;&#x7684;&#x6839;&#x3002;</p>
</li>
<li><p>&#x539F;&#x6811;&#x7684; Father &#x6307;&#x5411;&#x4E0D;&#x7B49;&#x4E8E;&#x8F85;&#x52A9;&#x6811;&#x7684; Father &#x6307;&#x5411;&#x3002;</p>
</li>
<li><p>&#x8F85;&#x52A9;&#x6811;&#x662F;&#x53EF;&#x4EE5;&#x5728;&#x6EE1;&#x8DB3;&#x8F85;&#x52A9;&#x6811;&#x3001;Splay &#x7684;&#x6027;&#x8D28;&#x4E0B;&#x4EFB;&#x610F;&#x6362;&#x6839;&#x7684;&#x3002;</p>
</li>
<li><p>&#x865A;&#x5B9E;&#x94FE;&#x53D8;&#x6362;&#x53EF;&#x4EE5;&#x8F7B;&#x677E;&#x5728;&#x8F85;&#x52A9;&#x6811;&#x4E0A;&#x5B8C;&#x6210;&#xFF0C;&#x8FD9;&#x4E5F;&#x5C31;&#x662F;&#x5B9E;&#x73B0;&#x4E86;&#x52A8;&#x6001;&#x7EF4;&#x62A4;&#x6811;&#x94FE;&#x5256;&#x5206;&#x3002;</p>
</li>
</ul>
<h3 id="&#x63A5;&#x4E0B;&#x6765;&#x8981;&#x7528;&#x5230;&#x7684;&#x53D8;&#x91CF;&#x58F0;&#x660E;">&#x63A5;&#x4E0B;&#x6765;&#x8981;&#x7528;&#x5230;&#x7684;&#x53D8;&#x91CF;&#x58F0;&#x660E;</h3>
<ul>
<li><p><code>ch[N][2]</code> &#x5DE6;&#x53F3;&#x2F09;&#x5B50;</p>
</li>
<li><p><code>f[N]</code> &#x2F57;&#x4EB2;&#x6307;&#x5411;</p>
</li>
<li><p><code>sum[N]</code> &#x8DEF;&#x5F84;&#x6743;&#x503C;&#x548C;</p>
</li>
<li><p><code>val[N]</code> &#x70B9;&#x6743;</p>
</li>
<li><p><code>tag[N]</code> &#x7FFB;&#x8F6C;&#x6807;&#x8BB0;</p>
</li>
<li><p><code>laz[N]</code> &#x6743;&#x503C;&#x6807;&#x8BB0;</p>
</li>
<li><p><code>siz[N]</code> &#x8F85;&#x52A9;&#x6811;&#x4E0A;&#x5B50;&#x6811;&#x5927;&#x5C0F;</p>
</li>
<li><p>Other_Vars</p>
</li>
</ul>
<h3 id="&#x51FD;&#x6570;&#x58F0;&#x660E;">&#x51FD;&#x6570;&#x58F0;&#x660E;</h3>
<h4 id="&#x2F00;&#x822C;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x51FD;&#x6570;&#xFF08;&#x5B57;&#x9762;&#x610F;&#x601D;&#xFF09;">&#x2F00;&#x822C;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x51FD;&#x6570;&#xFF08;&#x5B57;&#x9762;&#x610F;&#x601D;&#xFF09;</h4>
<ol>
<li><code>PushUp(x)</code> </li>
<li><code>PushDown(x)</code> </li>
</ol>
<h4 id="splay-&#x7CFB;&#x51FD;&#x6570;&#xFF08;&#x4E0D;&#x4F1A;&#x591A;&#x505A;&#x89E3;&#x91CA;&#xFF09;">Splay &#x7CFB;&#x51FD;&#x6570;&#xFF08;&#x4E0D;&#x4F1A;&#x591A;&#x505A;&#x89E3;&#x91CA;&#xFF09;</h4>
<ol>
<li><code>Get(x)</code> &#x83B7;&#x53D6; $x$ &#x662F;&#x7236;&#x4EB2;&#x7684;&#x54EA;&#x4E2A;&#x2F09;&#x5B50;&#x3002;</li>
<li><code>Splay(x)</code> &#x901A;&#x8FC7;&#x548C; Rotate &#x64CD;&#x4F5C;&#x8054;&#x52A8;&#x5B9E;&#x73B0;&#x628A; $x$ &#x65CB;&#x8F6C;&#x5230;<font color="red">&#x5F53;&#x524D; Splay &#x7684;&#x6839;</font>&#x3002;</li>
<li><code>Rotate(x)</code> &#x5C06; $x$ &#x5411;&#x4E0A;&#x65CB;&#x8F6C;&#x4E00;&#x5C42;&#x7684;&#x64CD;&#x4F5C;&#x3002;</li>
</ol>
<h4 id="&#x65B0;&#x64CD;&#x4F5C;">&#x65B0;&#x64CD;&#x4F5C;</h4>
<ol>
<li><code>Access(x)</code> &#x628A;&#x4ECE;&#x6839;&#x5230; $x$ &#x7684;&#x6240;&#x6709;&#x70B9;&#x653E;&#x5728;&#x2F00;&#x6761;&#x5B9E;&#x94FE;&#x91CC;&#xFF0C;&#x4F7F;&#x6839;&#x5230; $x$ &#x6210;&#x4E3A;&#x4E00;&#x6761;&#x5B9E;&#x8DEF;&#x5F84;&#xFF0C;&#x5E76;&#x4E14;&#x5728;&#x540C;&#x4E00;&#x68F5; Splay &#x91CC;&#x3002; <strong>&#x53EA;&#x6709;&#x6B64;&#x64CD;&#x4F5C;&#x662F;&#x5FC5;&#x987B;&#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x5176;&#x4ED6;&#x64CD;&#x4F5C;&#x89C6;&#x9898;&#x76EE;&#x800C;&#x5B9E;&#x73B0;&#x3002;</strong> </li>
<li><code>IsRoot(x)</code> &#x5224;&#x65AD; $x$ &#x662F;&#x5426;&#x662F;&#x6240;&#x5728;&#x6811;&#x7684;&#x6839;&#x3002;</li>
<li><code>Update(x)</code> &#x5728; <code>Access</code> &#x64CD;&#x4F5C;&#x4E4B;&#x540E;&#xFF0C;&#x9012;&#x5F52;&#x5730;&#x4ECE;&#x4E0A;&#x5230;&#x4E0B; <code>Pushdown</code> &#x66F4;&#x65B0;&#x4FE1;&#x606F;&#x3002;</li>
<li><code>MakeRoot(x)</code> &#x4F7F; $x$ &#x70B9;&#x6210;&#x4E3A;&#x5176;&#x6240;&#x5728;&#x6811;&#x7684;&#x6839;&#x3002;</li>
<li><code>Link(x, y)</code> &#x5728; $x, y$ &#x4E24;&#x70B9;&#x95F4;&#x8FDE;&#x4E00;&#x6761;&#x8FB9;&#x3002;</li>
<li><code>Cut(x, y)</code> &#x628A; $x, y$ &#x4E24;&#x70B9;&#x95F4;&#x8FB9;&#x5220;&#x6389;&#x3002;</li>
<li><code>Find(x)</code> &#x627E;&#x5230; $x$ &#x6240;&#x5728;&#x6811;&#x7684;&#x6839;&#x8282;&#x70B9;&#x7F16;&#x53F7;&#x3002;</li>
<li><code>Fix(x, v)</code> &#x4FEE;&#x6539; $x$ &#x7684;&#x70B9;&#x6743;&#x4E3A; $v$ &#x3002;</li>
<li><code>Split(x, y)</code> &#x63D0;&#x53D6;&#x51FA; $x, y$ &#x95F4;&#x7684;&#x8DEF;&#x5F84;&#xFF0C;&#x65B9;&#x4FBF;&#x505A;&#x533A;&#x95F4;&#x64CD;&#x4F5C;&#x3002;</li>
</ol>
<h3 id="&#x5B8F;&#x5B9A;&#x4E49;">&#x5B8F;&#x5B9A;&#x4E49;</h3>
<ul>
<li><code>#define ls ch[p][0]</code> </li>
<li><code>#define rs ch[p][1]</code> </li>
</ul>
<h2 id="&#x51FD;&#x6570;&#x8BB2;&#x89E3;">&#x51FD;&#x6570;&#x8BB2;&#x89E3;</h2>
<p>&#x5148;&#x4ECE;&#x7B80;&#x5355;&#x7684;&#x6765;&#x5427;</p>
<h3 id="pushup"><code>PushUp()</code></h3>
<pre><code class="lang-cpp"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">PushUp</span><span class="hljs-params">(<span class="hljs-keyword">int</span> p)</span> </span>{
  <span class="hljs-comment">// maintain other variables</span>
  siz[p] = siz[ls] + siz[rs];
}
</code></pre>
<h3 id="pushdown"><code>PushDown()</code></h3>
<pre><code class="lang-cpp"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">PushDown</span><span class="hljs-params">(<span class="hljs-keyword">int</span> p)</span> </span>{
  <span class="hljs-keyword">if</span> (tag[p] != std_tag) {
    <span class="hljs-comment">// pushdown the tag</span>
    tag[p] = std_tag;
  }
}
</code></pre>
<h3 id="splay--rotate"><code>Splay() &amp;&amp; Rotate()</code></h3>
<p>&#x6709;&#x4E9B;&#x4E0D;&#x4E00;&#x6837;&#x4E86;&#x54E6;&#x3002;</p>
<pre><code class="lang-cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> Get(x) (ch[f[x]][1] == x)</span>
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Rotate</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>{
  <span class="hljs-keyword">int</span> y = f[x], z = f[y], k = Get(x);
  <span class="hljs-keyword">if</span> (!isRoot(y)) ch[z][ch[z][<span class="hljs-number">1</span>] == y] = x;
  <span class="hljs-comment">// &#x4E0A;&#x9762;&#x8FD9;&#x53E5;&#x4E00;&#x5B9A;&#x8981;&#x5199;&#x5728;&#x524D;&#x9762;&#xFF0C;&#x666E;&#x901A;&#x7684;Splay&#x662F;&#x4E0D;&#x7528;&#x7684;&#xFF0C;&#x56E0;&#x4E3A; isRoot  (&#x540E;&#x9762;&#x4F1A;&#x8BB2;)</span>
  ch[y][k] = ch[x][!k], f[ch[y][k]] = y;
  ch[x][!k] = y, f[y] = x, f[x] = z;
  PushUp(x), PushUp(y);
}
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Splay</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>{
  Update(
      x);  <span class="hljs-comment">// &#x9A6C;&#x4E0A;&#x5C31;&#x80FD;&#x770B;&#x5230;&#x5566;&#x3002; &#x5728; Splay&#x4E4B;&#x524D;&#x8981;&#x628A;&#x65CB;&#x8F6C;&#x4F1A;&#x7ECF;&#x8FC7;&#x7684;&#x8DEF;&#x5F84;&#x4E0A;&#x7684;&#x70B9;&#x90FD;PushDown</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> fa; fa = f[x], !isRoot(x); Rotate(x)) {
    <span class="hljs-keyword">if</span> (!isRoot(fa)) Rotate(Get(fa) == Get(x) ? fa : x);
  }
}
</code></pre>
<p>&#x5982;&#x679C;&#x4E0A;&#x9762;&#x7684;&#x51E0;&#x4E2A;&#x51FD;&#x6570;&#x4F60;&#x770B;&#x4E0D;&#x61C2;&#xFF0C;&#x8BF7;&#x79FB;&#x6B65; <a href="splay.html">Splay</a> &#x3002;</p>
<p>&#x4E0B;&#x9762;&#x8981;&#x5F00;&#x59CB; LCT &#x72EC;&#x6709;&#x7684;&#x51FD;&#x6570;&#x4E86;&#x54E6;&#x3002;</p>
<h3 id="isroot"><code>isRoot()</code></h3>
<pre><code class="lang-cpp"><span class="hljs-comment">// &#x5728;&#x524D;&#x9762;&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x8BF4;&#x8FC7;&#xFF0C;LCT &#x5177;&#x6709; &#x5982;&#x679C;&#x4E00;&#x4E2A;&#x513F;&#x5B50;&#x4E0D;&#x662F;&#x5B9E;&#x513F;&#x5B50;&#xFF0C;&#x4ED6;&#x7684;&#x7236;&#x4EB2;&#x627E;&#x4E0D;&#x5230;&#x5B83;&#x7684;&#x6027;&#x8D28;</span>
<span class="hljs-comment">// &#x6240;&#x4EE5;&#x5F53;&#x4E00;&#x4E2A;&#x70B9;&#x65E2;&#x4E0D;&#x662F;&#x5B83;&#x7236;&#x4EB2;&#x7684;&#x5DE6;&#x513F;&#x5B50;&#xFF0C;&#x53C8;&#x4E0D;&#x662F;&#x5B83;&#x7236;&#x4EB2;&#x7684;&#x53F3;&#x513F;&#x5B50;&#xFF0C;&#x5B83;&#x5C31;&#x662F;&#x5F53;&#x524D; Splay &#x7684;&#x6839;</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> isRoot(x) (ch[f[x]][0] != x &amp;&amp; ch[f[x]][1] != x)</span>
</code></pre>
<h3 id="access"><code>Access()</code></h3>
<pre><code class="lang-cpp"><span class="hljs-comment">// Access &#x662F; LCT</span>
<span class="hljs-comment">// &#x7684;&#x6838;&#x5FC3;&#x64CD;&#x4F5C;&#xFF0C;&#x8BD5;&#x60F3;&#x6211;&#x4EEC;&#x50CF;&#x6C42;&#x89E3;&#x4E00;&#x6761;&#x8DEF;&#x5F84;&#xFF0C;&#x800C;&#x8FD9;&#x6761;&#x8DEF;&#x5F84;&#x6070;&#x597D;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x5F53;&#x524D;&#x7684;&#x4E00;&#x68F5; Splay&#xFF0C;</span>
<span class="hljs-comment">// &#x76F4;&#x63A5;&#x8C03;&#x7528;&#x5176;&#x4FE1;&#x606F;&#x5373;&#x53EF;&#x3002;&#x5148;&#x6765;&#x770B;&#x4E00;&#x4E0B;&#x4EE3;&#x7801;&#xFF0C;&#x518D;&#x7ED3;&#x5408;&#x56FE;&#x6765;&#x770B;&#x770B;&#x8FC7;&#x7A0B;</span>
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">Access</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>{
  <span class="hljs-keyword">int</span> p;
  <span class="hljs-keyword">for</span> (p = <span class="hljs-number">0</span>; x; p = x, x = f[x]) {
    Splay(x), ch[x][<span class="hljs-number">1</span>] = p, PushUp(x);
  }
  <span class="hljs-keyword">return</span> p;
}
</code></pre>
<p>&#x6211;&#x4EEC;&#x6709;&#x8FD9;&#x6837;&#x4E00;&#x68F5;&#x6811;&#xFF0C;&#x5B9E;&#x7EBF;&#x4E3A;&#x5B9E;&#x8FB9;&#xFF0C;&#x865A;&#x7EBF;&#x4E3A;&#x865A;&#x8FB9;&#x3002;</p>
<p><img src="images/lct1.png" alt="pic1"></p>
<ul>
<li>&#x5B83;&#x7684;&#x8F85;&#x52A9;&#x6811;&#x53EF;&#x80FD;&#x957F;&#x6210;&#x8FD9;&#x6837;&#xFF08;&#x6784;&#x56FE;&#x65B9;&#x5F0F;&#x4E0D;&#x540C;&#x53EF;&#x80FD; LCT &#x7684;&#x7ED3;&#x6784;&#x4E5F;&#x4E0D;&#x540C;&#xFF09;&#x3002;</li>
<li>&#x6BCF;&#x4E2A;&#x7EFF;&#x6846;&#x91CC;&#x662F;&#x4E00;&#x68F5; Splay&#x3002;</li>
</ul>
<p><img src="images/lct2.png" alt="pic2"></p>
<ul>
<li>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x8981; <code>Access(N)</code> , &#x628A; $A$ &#x5230; $N$ &#x8DEF;&#x5F84;&#x4E0A;&#x7684;&#x8FB9;&#x90FD;&#x53D8;&#x4E3A;&#x5B9E;&#x8FB9;&#xFF0C;&#x62C9;&#x6210;&#x4E00;&#x68F5; Splay&#x3002;</li>
</ul>
<p><img src="images/lct3.png" alt="pic3"></p>
<ul>
<li>&#x5B9E;&#x73B0;&#x7684;&#x65B9;&#x6CD5;&#x662F;&#x4ECE;&#x4E0B;&#x5230;&#x4E0A;&#x9010;&#x6B65;&#x66F4;&#x65B0; Splay&#x3002;</li>
<li>&#x9996;&#x5148;&#x6211;&#x4EEC;&#x8981;&#x628A; $N$ &#x65CB;&#x81F3;&#x5F53;&#x524D; Splay &#x7684;&#x6839;&#x3002;</li>
<li>&#x4E3A;&#x4E86;&#x4FDD;&#x8BC1; AuxTree&#xFF08;&#x8F85;&#x52A9;&#x6811;&#xFF09;&#x7684;&#x6027;&#x8D28;&#xFF0C;&#x539F;&#x6765; $N$ &#x5230; $O$ &#x7684;&#x5B9E;&#x8FB9;&#x8981;&#x66F4;&#x6539;&#x4E3A;&#x865A;&#x8FB9;&#x3002;</li>
<li>&#x7531;&#x4E8E;&#x8BA4;&#x7236;&#x4E0D;&#x8BA4;&#x5B50;&#x7684;&#x6027;&#x8D28;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5355;&#x65B9;&#x9762;&#x7684;&#x628A; $N$ &#x7684;&#x513F;&#x5B50;&#x6539;&#x4E3A; Null&#x3002;</li>
<li>&#x4E8E;&#x662F;&#x539F;&#x6765;&#x7684; AuxTree &#x5C31;&#x4ECE;&#x4E0B;&#x56FE;&#x53D8;&#x6210;&#x4E86;&#x4E0B;&#x4E0B;&#x56FE;&#x3002;</li>
</ul>
<p><img src="images/lct4.png" alt="pic4"></p>
<p><img src="images/lct5.png" alt="pic"></p>
<ul>
<li><p>&#x4E0B;&#x4E00;&#x6B65;&#xFF0C;&#x6211;&#x4EEC;&#x628A; $N$ &#x6307;&#x5411;&#x7684; Father $I$ &#x4E5F;&#x65CB;&#x8F6C;&#x5230; $I$ &#x7684; Splay &#x6811;&#x6839;&#x3002;</p>
</li>
<li><p>&#x539F;&#x6765;&#x7684;&#x5B9E;&#x8FB9; $I$ &#x2014; $K$ &#x8981;&#x53BB;&#x6389;&#xFF0C;&#x8FD9;&#x65F6;&#x5019;&#x6211;&#x4EEC;&#x628A; $I$ &#x7684;&#x53F3;&#x513F;&#x5B50;&#x6307;&#x5411; $N$ , &#x5C31;&#x5F97;&#x5230;&#x4E86; $I$ &#x2014; $L$ &#x8FD9;&#x6837;&#x4E00;&#x68F5; Splay&#x3002;</p>
</li>
</ul>
<p><img src="images/lct8.png" alt="pic"></p>
<ul>
<li><p>&#x63A5;&#x4E0B;&#x6765;&#xFF0C;&#x6309;&#x7167;&#x521A;&#x521A;&#x7684;&#x64CD;&#x4F5C;&#x6B65;&#x9AA4;&#xFF0C;&#x7531;&#x4E8E; $I$ &#x7684; Father &#x6307;&#x5411; $H$ , &#x6211;&#x4EEC;&#x628A; $H$ &#x65CB;&#x8F6C;&#x5230;&#x4ED6;&#x6240;&#x5728; Splay Tree &#x7684;&#x6839;&#xFF0C;&#x7136;&#x540E;&#x628A; $H$ &#x7684; rs &#x8BBE;&#x4E3A; $I$ &#x3002;</p>
</li>
<li><p>&#x4E4B;&#x540E;&#x7684;&#x6811;&#x662F;&#x8FD9;&#x6837;&#x7684;&#x3002;</p>
</li>
</ul>
<p><img src="images/lct6.png" alt="pic"></p>
<ul>
<li>&#x540C;&#x7406;&#x6211;&#x4EEC; <code>Splay(A)</code> , &#x5E76;&#x628A; $A$ &#x7684;&#x53F3;&#x513F;&#x5B50;&#x6307;&#x5411; $H$ &#x3002;</li>
<li>&#x4E8E;&#x662F;&#x6211;&#x4EEC;&#x5F97;&#x5230;&#x4E86;&#x8FD9;&#x6837;&#x4E00;&#x68F5; AuxTree&#x3002;&#x5E76;&#x4E14;&#x53D1;&#x73B0; $A$ &#x2014; $N$ &#x7684;&#x6574;&#x4E2A;&#x8DEF;&#x5F84;&#x5DF2;&#x7ECF;&#x5728;&#x540C;&#x4E00;&#x68F5; Splay &#x4E2D;&#x4E86;&#x3002;&#x5927;&#x529F;&#x544A;&#x6210;&#xFF01;</li>
</ul>
<p><img src="images/lct7.png" alt="pic"></p>
<pre><code class="lang-cpp"><span class="hljs-comment">// &#x56DE;&#x987E;&#x4E00;&#x4E0B;&#x4EE3;&#x7801;</span>
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">Access</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>{
  <span class="hljs-keyword">int</span> p;
  <span class="hljs-keyword">for</span> (p = <span class="hljs-number">0</span>; x; p = x, x = f[x]) {
    Splay(x), ch[x][<span class="hljs-number">1</span>] = p, PushUp(x);
  }
  <span class="hljs-keyword">return</span> p;
}
</code></pre>
<p>&#x6211;&#x4EEC;&#x53D1;&#x73B0; <code>Access()</code> &#x5176;&#x5B9E;&#x5F88;&#x5BB9;&#x6613;&#xFF0C;&#x53EA;&#x6709;&#x5982;&#x4E0B;&#x56DB;&#x6B65;&#x64CD;&#x4F5C;&#xFF1A;</p>
<ol>
<li>&#x628A;&#x5F53;&#x524D;&#x8282;&#x70B9;&#x8F6C;&#x5230;&#x6839;&#x3002;</li>
<li>&#x628A;&#x513F;&#x5B50;&#x6362;&#x6210;&#x4E4B;&#x524D;&#x7684;&#x8282;&#x70B9;&#x3002;</li>
<li>&#x66F4;&#x65B0;&#x5F53;&#x524D;&#x70B9;&#x7684;&#x4FE1;&#x606F;&#x3002;</li>
<li>&#x628A;&#x5F53;&#x524D;&#x70B9;&#x6362;&#x6210;&#x5F53;&#x524D;&#x70B9;&#x7684;&#x7236;&#x4EB2;&#xFF0C;&#x7EE7;&#x7EED;&#x64CD;&#x4F5C;&#x3002;</li>
</ol>
<p>&#x8FD9;&#x91CC;&#x63D0;&#x4F9B;&#x7684; Access &#x8FD8;&#x6709;&#x4E00;&#x4E2A;&#x8FD4;&#x56DE;&#x503C;&#x3002;&#x8FD9;&#x4E2A;&#x8FD4;&#x56DE;&#x503C;&#x76F8;&#x5F53;&#x4E8E;&#x6700;&#x540E;&#x4E00;&#x6B21;&#x865A;&#x5B9E;&#x94FE;&#x53D8;&#x6362;&#x65F6;&#x865A;&#x8FB9;&#x7236;&#x4EB2;&#x8282;&#x70B9;&#x7684;&#x503C;&#x3002;&#x8BE5;&#x503C;&#x6709;&#x4E24;&#x4E2A;&#x542B;&#x4E49;&#xFF1A;</p>
<ul>
<li><p>&#x8FDE;&#x7EED;&#x4E24;&#x6B21; Access &#x64CD;&#x4F5C;&#x65F6;&#xFF0C;&#x7B2C;&#x4E8C;&#x6B21; Access &#x64CD;&#x4F5C;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x7B49;&#x4E8E;&#x8FD9;&#x4E24;&#x4E2A;&#x8282;&#x70B9;&#x7684; LCA.</p>
</li>
<li><p>&#x8868;&#x793A; $x$ &#x5230;&#x6839;&#x7684;&#x94FE;&#x6240;&#x5728;&#x7684; Splay &#x6811;&#x7684;&#x6839;&#x3002;&#x8FD9;&#x4E2A;&#x8282;&#x70B9;&#x4E00;&#x5B9A;&#x5DF2;&#x7ECF;&#x88AB;&#x65CB;&#x8F6C;&#x5230;&#x4E86;&#x6839;&#x8282;&#x70B9;&#xFF0C;&#x4E14;&#x7236;&#x4EB2;&#x4E00;&#x5B9A;&#x4E3A;&#x7A7A;&#x3002;</p>
</li>
</ul>
<h3 id="update"><code>Update()</code></h3>
<pre><code class="lang-cpp"><span class="hljs-comment">// &#x4ECE;&#x4E0A;&#x5230;&#x4E0B;&#x4E00;&#x5C42;&#x4E00;&#x5C42; pushDown &#x5373;&#x53EF;</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Update</span><span class="hljs-params">(<span class="hljs-keyword">int</span> p)</span> </span>{
  <span class="hljs-keyword">if</span> (!isRoot(p)) Update(f[p]);
  pushDown(p);
}
</code></pre>
<h3 id="makeroot"><code>makeRoot()</code></h3>
<ul>
<li><code>Make_Root()</code> &#x7684;&#x91CD;&#x8981;&#x6027;&#x4E1D;&#x6BEB;&#x4E0D;&#x4E9A;&#x4E8E; <code>Access()</code> &#x3002;&#x6211;&#x4EEC;&#x5728;&#x9700;&#x8981;&#x7EF4;&#x62A4;&#x8DEF;&#x5F84;&#x4FE1;&#x606F;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4E00;&#x5B9A;&#x4F1A;&#x51FA;&#x73B0;&#x8DEF;&#x5F84;&#x6DF1;&#x5EA6;&#x65E0;&#x6CD5;&#x4E25;&#x683C;&#x9012;&#x589E;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x6839;&#x636E; AuxTree &#x7684;&#x6027;&#x8D28;&#xFF0C;&#x8FD9;&#x79CD;&#x8DEF;&#x5F84;&#x662F;&#x4E0D;&#x80FD;&#x51FA;&#x73B0;&#x5728;&#x4E00;&#x68F5; Splay &#x4E2D;&#x7684;&#x3002;</li>
<li>&#x8FD9;&#x65F6;&#x5019;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x7528;&#x5230; <code>Make_Root()</code> &#x3002;</li>
<li><code>Make_Root()</code> &#x7684;&#x4F5C;&#x7528;&#x662F;&#x4F7F;&#x6307;&#x5B9A;&#x7684;&#x70B9;&#x6210;&#x4E3A;&#x539F;&#x6811;&#x7684;&#x6839;&#xFF0C;&#x8003;&#x8651;&#x5982;&#x4F55;&#x5B9E;&#x73B0;&#x8FD9;&#x79CD;&#x64CD;&#x4F5C;&#x3002;</li>
<li>&#x8BBE; <code>Access(x)</code> &#x7684;&#x8FD4;&#x56DE;&#x503C;&#x4E3A; $y$ &#xFF0C;&#x5219;&#x6B64;&#x65F6; $x$ &#x5230;&#x5F53;&#x524D;&#x6839;&#x7684;&#x8DEF;&#x5F84;&#x6070;&#x597D;&#x6784;&#x6210;&#x4E00;&#x4E2A; Splay&#xFF0C;&#x4E14;&#x8BE5; Splay &#x7684;&#x6839;&#x4E3A; $y$ .</li>
<li>&#x8003;&#x8651;&#x5C06;&#x6811;&#x7528;&#x6709;&#x5411;&#x56FE;&#x8868;&#x793A;&#x51FA;&#x6765;&#xFF0C;&#x7ED9;&#x6BCF;&#x6761;&#x8FB9;&#x5B9A;&#x4E00;&#x4E2A;&#x65B9;&#x5411;&#xFF0C;&#x8868;&#x793A;&#x4ECE;&#x513F;&#x5B50;&#x5230;&#x7236;&#x4EB2;&#x7684;&#x65B9;&#x5411;&#x3002;&#x5BB9;&#x6613;&#x53D1;&#x73B0;&#x6362;&#x6839;&#x76F8;&#x5F53;&#x4E8E;&#x5C06; $x$ &#x5230;&#x6839;&#x7684;&#x8DEF;&#x5F84;&#x7684;&#x6240;&#x6709;&#x8FB9;&#x53CD;&#x5411;&#xFF08;&#x8BF7;&#x4ED4;&#x7EC6;&#x601D;&#x8003;&#xFF09;&#x3002;</li>
<li>&#x56E0;&#x6B64;&#x5C06; $x$ &#x5230;&#x5F53;&#x524D;&#x6839;&#x7684;&#x8DEF;&#x5F84;&#x7FFB;&#x8F6C;&#x5373;&#x53EF;&#x3002;</li>
<li>&#x7531;&#x4E8E; $y$ &#x662F; $x$ &#x5230;&#x5F53;&#x524D;&#x6839;&#x7684;&#x8DEF;&#x5F84;&#x6240;&#x4EE3;&#x8868;&#x7684; Splay &#x7684;&#x6839;&#xFF0C;&#x56E0;&#x6B64;&#x5C06;&#x4EE5; $y$ &#x4E3A;&#x6839;&#x7684; Splay &#x6811;&#x8FDB;&#x884C;&#x533A;&#x95F4;&#x7FFB;&#x8F6C;&#x5373;&#x53EF;&#x3002;</li>
</ul>
<pre><code class="lang-cpp"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">makeRoot</span><span class="hljs-params">(<span class="hljs-keyword">int</span> p)</span> </span>{
  p = Access(p);
  swap(ch[p][<span class="hljs-number">0</span>], ch[p][<span class="hljs-number">1</span>]);
  tag[p] ^= <span class="hljs-number">1</span>;
}
</code></pre>
<h3 id="link"><code>Link()</code></h3>
<ul>
<li>Link &#x4E24;&#x4E2A;&#x70B9;&#x5176;&#x5B9E;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x5148; <code>Make_Root(x)</code> , &#x7136;&#x540E;&#x628A; $x$ &#x7684;&#x7236;&#x4EB2;&#x6307;&#x5411; $y$ &#x5373;&#x53EF;&#x3002;&#x663E;&#x7136;&#xFF0C;&#x8FD9;&#x4E2A;&#x64CD;&#x4F5C;&#x80AF;&#x5B9A;&#x4E0D;&#x80FD;&#x53D1;&#x751F;&#x5728;&#x540C;&#x4E00;&#x68F5;&#x6811;&#x5185;&#xFF0C;&#x6240;&#x4EE5;&#x8BB0;&#x5F97;&#x5148;&#x5224;&#x4E00;&#x4E0B;&#x3002;</li>
</ul>
<pre><code class="lang-cpp"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Link</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> p)</span> </span>{
  makeRoot(x);
  f[x] = p;
}
</code></pre>
<h3 id="split"><code>Split()</code></h3>
<ul>
<li><code>Split</code> &#x64CD;&#x4F5C;&#x610F;&#x4E49;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x5C31;&#x662F;&#x62FF;&#x51FA;&#x4E00;&#x68F5; Splay , &#x7EF4;&#x62A4;&#x7684;&#x662F; $x$ &#x5230; $y$ &#x7684;&#x8DEF;&#x5F84;&#x3002;</li>
<li>&#x5148; <code>MakeRoot(x)</code> &#xFF0C;&#x7136;&#x540E; <code>Access(y)</code> &#x3002;&#x5982;&#x679C;&#x8981; $y$ &#x505A;&#x6839;&#xFF0C;&#x518D; <code>Splay(y)</code> &#x3002;</li>
<li>&#x5C31;&#x8FD9;&#x4E09;&#x53E5;&#x8BDD;&#xFF0C;&#x6CA1;&#x5199;&#x4EE3;&#x7801;&#xFF0C;&#x9700;&#x8981;&#x7684;&#x65F6;&#x5019;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x6253;&#x8FD9;&#x4E09;&#x4E2A;&#x5C31;&#x597D;&#x8FA3;&#xFF01;</li>
<li>&#x53E6;&#x5916; Split &#x8FD9;&#x4E09;&#x4E2A;&#x64CD;&#x4F5C;&#x76F4;&#x63A5;&#x53EF;&#x4EE5;&#x628A;&#x9700;&#x8981;&#x7684;&#x8DEF;&#x5F84;&#x62FF;&#x51FA;&#x5230; $y$ &#x7684;&#x5B50;&#x6811;&#x4E0A;&#xFF0C;&#x90A3;&#x4E0D;&#x662F;&#x968F;&#x4FBF;&#x5E72;&#x561B;&#x54AF;&#x3002;</li>
</ul>
<h3 id="cut"><code>Cut()</code></h3>
<ul>
<li><code>Cut</code> &#x6709;&#x4E24;&#x79CD;&#x60C5;&#x51B5;&#xFF0C;&#x4FDD;&#x8BC1;&#x5408;&#x6CD5;&#x548C;&#x4E0D;&#x4E00;&#x5B9A;&#x4FDD;&#x8BC1;&#x5408;&#x6CD5;&#x3002;&#xFF08;&#x5E9F;&#x8BDD;&#xFF09;</li>
<li>&#x5982;&#x679C;&#x4FDD;&#x8BC1;&#x5408;&#x6CD5;&#xFF0C;&#x76F4;&#x63A5; <code>Split(x, y)</code> &#xFF0C;&#x8FD9;&#x65F6;&#x5019; $y$ &#x662F;&#x6839;&#xFF0C; $x$ &#x4E00;&#x5B9A;&#x662F;&#x5B83;&#x7684;&#x513F;&#x5B50;&#xFF0C;&#x53CC;&#x5411;&#x65AD;&#x5F00;&#x5373;&#x53EF;&#x3002;&#x5C31;&#x50CF;&#x8FD9;&#x6837;&#xFF1A;</li>
</ul>
<pre><code class="lang-cpp"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Cut</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> p)</span> </span>{
  makeRoot(x), Access(p), Splay(p), ls = f[x] = <span class="hljs-number">0</span>;
}
</code></pre>
<p>&#x5982;&#x679C;&#x662F;&#x4E0D;&#x4FDD;&#x8BC1;&#x5408;&#x6CD5;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5224;&#x65AD;&#x4E00;&#x4E0B;&#x662F;&#x5426;&#x6709;&#xFF0C;&#x6211;&#x9009;&#x62E9;&#x4F7F;&#x7528; <code>map</code> &#x5B58;&#x4E00;&#x4E0B;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x91CC;&#x6709;&#x4E00;&#x4E2A;&#x5229;&#x7528;&#x6027;&#x8D28;&#x7684;&#x65B9;&#x6CD5;&#xFF1A;</p>
<p>&#x60F3;&#x8981;&#x5220;&#x8FB9;&#xFF0C;&#x5FC5;&#x987B;&#x8981;&#x6EE1;&#x8DB3;&#x5982;&#x4E0B;&#x4E09;&#x4E2A;&#x6761;&#x4EF6;&#xFF1A;</p>
<ol>
<li>$x,y$ &#x8FDE;&#x901A;&#x3002;</li>
<li>$x,y$ &#x7684;&#x8DEF;&#x5F84;&#x4E0A;&#x6CA1;&#x6709;&#x5176;&#x4ED6;&#x7684;&#x94FE;&#x3002;</li>
<li>$x$ &#x6CA1;&#x6709;&#x53F3;&#x513F;&#x5B50;&#x3002;</li>
</ol>
<p>&#x603B;&#x7ED3;&#x4E00;&#x4E0B;&#xFF0C;&#x4E0A;&#x9762;&#x4E09;&#x53E5;&#x8BDD;&#x7684;&#x610F;&#x601D;&#x5C31;&#x4E00;&#x4E2A;&#xFF1A; $x,y$ &#x4E4B;&#x95F4;&#x6709;&#x8FB9;&#x3002;</p>
<p>&#x5177;&#x4F53;&#x5B9E;&#x73B0;&#x5C31;&#x7559;&#x4F5C;&#x4E00;&#x4E2A;&#x601D;&#x8003;&#x9898;&#x7ED9;&#x5927;&#x5BB6;&#x3002;&#x5224;&#x65AD;&#x8FDE;&#x901A;&#x9700;&#x8981;&#x7528;&#x5230;&#x540E;&#x9762;&#x7684; <code>Find</code> , &#x5176;&#x4ED6;&#x4E24;&#x70B9;&#x7A0D;&#x4F5C;&#x601D;&#x8003;&#x5206;&#x6790;&#x4E00;&#x4E0B;&#x7ED3;&#x6784;&#x5C31;&#x77E5;&#x9053;&#x8BE5;&#x600E;&#x4E48;&#x5224;&#x65AD;&#x4E86;&#x3002;</p>
<h3 id="find"><code>Find()</code></h3>
<ul>
<li><code>Find()</code> &#x5176;&#x5B9E;&#x5C31;&#x662F;&#x627E;&#x5230;&#x5F53;&#x524D;&#x8F85;&#x52A9;&#x6811;&#x7684;&#x6839;&#x3002;&#x5728; <code>Access(p)</code> &#x540E;&#xFF0C;&#x518D; <code>Splay(p)</code> &#x3002;&#x8FD9;&#x6837;&#x6839;&#x5C31;&#x662F;&#x6811;&#x91CC;&#x6700;&#x5C0F;&#x7684;&#x90A3;&#x4E2A;&#xFF0C;&#x4E00;&#x76F4;&#x5F80; ls &#x8D70;&#xFF0C;&#x6CBF;&#x9014; <code>PushDown</code> &#x5373;&#x53EF;&#x3002;</li>
<li>&#x4E00;&#x76F4;&#x8D70;&#x5230;&#x6CA1;&#x6709; ls, &#x975E;&#x5E38;&#x7B80;&#x5355;&#x3002;</li>
</ul>
<pre><code class="lang-cpp"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">Find</span><span class="hljs-params">(<span class="hljs-keyword">int</span> p)</span> </span>{
  Access(p), Splay(p);
  <span class="hljs-keyword">while</span> (ls) pushDown(p), p = ls;
  <span class="hljs-keyword">return</span> p;
}
</code></pre>
<h3 id="&#x4E00;&#x4E9B;&#x63D0;&#x9192;">&#x4E00;&#x4E9B;&#x63D0;&#x9192;</h3>
<ul>
<li>&#x5E72;&#x70B9;&#x5565;&#x524D;&#x4E00;&#x5B9A;&#x8981;&#x60F3;&#x4E00;&#x60F3;&#x9700;&#x4E0D;&#x9700;&#x8981; <code>PushUp</code> &#x6216;&#x8005; <code>PushDown</code> , LCT &#x7531;&#x4E8E;&#x7279;&#x522B;&#x7075;&#x6D3B;&#x7684;&#x539F;&#x56E0;&#xFF0C;&#x5C11; <code>Pushdown</code> &#x6216;&#x8005; <code>Pushup</code> &#x4E00;&#x6B21;&#x5C31;&#x53EF;&#x80FD;&#x628A;&#x4FEE;&#x6539;&#x6539;&#x5230;&#x4E0D;&#x8BE5;&#x6539;&#x7684;&#x70B9;&#x4E0A;&#xFF01;</li>
<li>LCT &#x7684; <code>Rotate</code> &#x548C; Splay &#x7684;&#x4E0D;&#x592A;&#x4E00;&#x6837;&#xFF0C; <code>if (z)</code> &#x4E00;&#x5B9A;&#x8981;&#x653E;&#x5728;&#x524D;&#x9762;&#x3002;</li>
<li>LCT &#x7684; <code>Splay</code> &#x64CD;&#x4F5C;&#x5C31;&#x662F;&#x65CB;&#x8F6C;&#x5230;&#x6839;&#xFF0C;&#x6CA1;&#x6709;&#x65CB;&#x8F6C;&#x5230;&#x8C01;&#x513F;&#x5B50;&#x7684;&#x64CD;&#x4F5C;&#xFF0C;&#x56E0;&#x4E3A;&#x4E0D;&#x9700;&#x8981;&#x3002;</li>
</ul>
<h2 id="&#x4E60;&#x9898;">&#x4E60;&#x9898;</h2>
<ul>
<li><a href="https://lydsy.com/JudgeOnline/problem.php?id=3282" target="_blank">&#x300C;BZOJ 3282&#x300D;Tree</a> </li>
<li><a href="https://www.luogu.org/problem/P3203" target="_blank">&#x300C;HNOI2010&#x300D;&#x5F39;&#x98DE;&#x7EF5;&#x7F8A;</a> </li>
</ul>
<h2 id="&#x7EF4;&#x62A4;&#x6811;&#x94FE;&#x4FE1;&#x606F;">&#x7EF4;&#x62A4;&#x6811;&#x94FE;&#x4FE1;&#x606F;</h2>
<p>LCT &#x901A;&#x8FC7; <code>Split(x,y)</code> &#x64CD;&#x4F5C;&#xFF0C;&#x53EF;&#x4EE5;&#x5C06;&#x6811;&#x4E0A;&#x4ECE;&#x70B9; $x$ &#x5230;&#x70B9; $y$ &#x7684;&#x8DEF;&#x5F84;&#x63D0;&#x53D6;&#x5230;&#x4EE5; $y$ &#x4E3A;&#x6839;&#x7684; Splay &#x5185;&#xFF0C;&#x6811;&#x94FE;&#x4FE1;&#x606F;&#x7684;&#x4FEE;&#x6539;&#x548C;&#x7EDF;&#x8BA1;&#x8F6C;&#x5316;&#x4E3A;&#x5E73;&#x8861;&#x6811;&#x4E0A;&#x7684;&#x64CD;&#x4F5C;&#xFF0C;&#x8FD9;&#x4F7F;&#x5F97; LCT &#x5728;&#x7EF4;&#x62A4;&#x6811;&#x94FE;&#x4FE1;&#x606F;&#x4E0A;&#x5177;&#x6709;&#x4F18;&#x52BF;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x501F;&#x52A9; LCT &#x5B9E;&#x73B0;&#x7684;&#x5728;&#x6811;&#x94FE;&#x4E0A;&#x4E8C;&#x5206;&#x6BD4;&#x6811;&#x94FE;&#x5256;&#x5206;&#x5C11;&#x4E00;&#x4E2A; $O(\log n)$ &#x7684;&#x590D;&#x6742;&#x5EA6;&#x3002;</p>
<p>???+note &quot; &#x4F8B;&#x9898;<a href="https://www.luogu.org/problemnew/show/P1501" target="_blank">&#x300C;&#x56FD;&#x5BB6;&#x96C6;&#x8BAD;&#x961F;&#x300D;Tree II</a>&quot;
    &#x7ED9;&#x51FA;&#x4E00;&#x68F5;&#x6709; $n$ &#x4E2A;&#x7ED3;&#x70B9;&#x7684;&#x6811;&#xFF0C;&#x6BCF;&#x4E2A;&#x70B9;&#x7684;&#x521D;&#x59CB;&#x6743;&#x503C;&#x4E3A; $1$ &#x3002; $q$ &#x6B21;&#x64CD;&#x4F5C;&#xFF0C;&#x6BCF;&#x6B21;&#x64CD;&#x4F5C;&#x5747;&#x4E3A;&#x4EE5;&#x4E0B;&#x56DB;&#x79CD;&#x4E4B;&#x4E00;&#xFF1A;</p>
<pre><code>1.   `- u1 v1 u2 v2` &#xFF1A;&#x5C06;&#x6811;&#x4E0A; $u_1,v_1$ &#x4E24;&#x70B9;&#x4E4B;&#x95F4;&#x7684;&#x8FB9;&#x5220;&#x9664;&#xFF0C;&#x8FDE;&#x63A5; $u_2,v_2$ &#x4E24;&#x70B9;&#xFF0C;&#x4FDD;&#x8BC1;&#x64CD;&#x4F5C;&#x5408;&#x6CD5;&#x4E14;&#x8FDE;&#x8FB9;&#x540E;&#x4ECD;&#x662F;&#x4E00;&#x68F5;&#x6811;&#x3002;
2.   `+ u v c` &#xFF1A;&#x5C06;&#x6811;&#x4E0A; $u,v$ &#x4E24;&#x70B9;&#x4E4B;&#x95F4;&#x7684;&#x8DEF;&#x5F84;&#x4E0A;&#x7684;&#x70B9;&#x6743;&#x90FD;&#x589E;&#x52A0; $c$ &#x3002;
3.   `* u v c` &#xFF1A;&#x5C06;&#x6811;&#x4E0A; $u,v$ &#x4E24;&#x70B9;&#x4E4B;&#x95F4;&#x7684;&#x8DEF;&#x5F84;&#x4E0A;&#x7684;&#x70B9;&#x6743;&#x90FD;&#x4E58;&#x4EE5; $c$ &#x3002;
4.   `/u v` &#xFF1A;&#x8F93;&#x51FA;&#x6811;&#x4E0A; $u,v$ &#x4E24;&#x70B9;&#x4E4B;&#x95F4;&#x7684;&#x8DEF;&#x5F84;&#x4E0A;&#x7684;&#x70B9;&#x6743;&#x4E4B;&#x548C;&#x5BF9; $51061$ &#x53D6;&#x6A21;&#x540E;&#x7684;&#x503C;&#x3002;

 $1\le n,q\le 10^5,0\le c\le 10^4$ 

 `-` &#x64CD;&#x4F5C;&#x53EF;&#x4EE5;&#x76F4;&#x63A5; `Cut(u1,v1),Link(u2,v2)` &#x3002;
</code></pre><p>&#x5BF9;&#x6811;&#x4E0A; $u,v$ &#x4E24;&#x70B9;&#x4E4B;&#x95F4;&#x7684;&#x8DEF;&#x5F84;&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#x65F6;&#xFF0C;&#x5148; <code>Split(u,v)</code> &#x3002;</p>
<p>&#x6B64;&#x9898;&#x8981;&#x6C42;&#x8FDB;&#x884C;&#x5728;&#x8F85;&#x52A9;&#x6811;&#x4E0A;&#x7684;&#x5B50;&#x6811;&#x52A0;&#xFF0C;&#x5B50;&#x6811;&#x4E58;&#xFF0C;&#x5B50;&#x6811;&#x6C42;&#x548C;&#x64CD;&#x4F5C;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x9664;&#x4E86;&#x4E00;&#x822C; LCT &#x9700;&#x8981;&#x7EF4;&#x62A4;&#x7684;&#x5B50;&#x6811;&#x7FFB;&#x8F6C;&#x6807;&#x8BB0;&#xFF0C;&#x8FD8;&#x8981;&#x7EF4;&#x62A4;&#x5B50;&#x6811;&#x52A0;&#x6CD5;&#x6807;&#x8BB0;&#x548C;&#x5B50;&#x6811;&#x4E58;&#x6CD5;&#x6807;&#x8BB0;&#x3002;&#x5904;&#x7406;&#x6807;&#x8BB0;&#x7684;&#x65B9;&#x6CD5;&#x548C;&#x5728; Splay &#x4E0A;&#x662F;&#x4E00;&#x6837;&#x7684;&#x3002;</p>
<p>&#x5728;&#x6253;&#x4E0A;&#x548C;&#x4E0B;&#x4F20;&#x52A0;&#x6CD5;&#x6807;&#x8BB0;&#x65F6;&#xFF0C;&#x5B50;&#x6811;&#x6743;&#x503C;&#x548C;&#x7684;&#x53D8;&#x5316;&#x91CF;&#x548C;&#x5B50;&#x6811;&#x4E2D;&#x7684;&#x7ED3;&#x70B9;&#x6570;&#x6709;&#x5173;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x8FD8;&#x8981;&#x7EF4;&#x62A4;&#x5B50;&#x6811;&#x7684;&#x5927;&#x5C0F; <code>siz</code> &#x3002;</p>
<p>&#x5728;&#x4E0B;&#x4F20;&#x6807;&#x8BB0;&#x65F6;&#xFF0C;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x987A;&#x5E8F;&#xFF0C;&#x5148;&#x4E0B;&#x4F20;&#x4E58;&#x6CD5;&#x6807;&#x8BB0;&#x518D;&#x4E0B;&#x4F20;&#x52A0;&#x6CD5;&#x6807;&#x8BB0;&#x3002;&#x5B50;&#x6811;&#x7FFB;&#x8F6C;&#x548C;&#x5B50;&#x6811;&#x52A0;&#x4E58;&#x4E24;&#x79CD;&#x6807;&#x8BB0;&#x6CA1;&#x6709;&#x51B2;&#x7A81;&#x3002;</p>
<p>??? &quot;&#x53C2;&#x8003;&#x4EE3;&#x7801;&quot;</p>
<pre><code>```cpp
#include &lt;algorithm&gt;
#include &lt;cstdio&gt;
#include &lt;cstring&gt;
using namespace std;
#define int long long
const int maxn = 100010;
const int mod = 51061;
int n, q, u, v, c;
char op;
struct Splay {
  int ch[maxn][2], fa[maxn], siz[maxn], val[maxn], sum[maxn], rev[maxn],
      add[maxn], mul[maxn];
  void clear(int x) {
    ch[x][0] = ch[x][1] = fa[x] = siz[x] = val[x] = sum[x] = rev[x] = add[x] =
        0;
    mul[x] = 1;
  }
  int getch(int x) { return (ch[fa[x]][1] == x); }
  int isroot(int x) {
    clear(0);
    return ch[fa[x]][0] != x &amp;&amp; ch[fa[x]][1] != x;
  }
  void maintain(int x) {
    clear(0);
    siz[x] = (siz[ch[x][0]] + 1 + siz[ch[x][1]]) % mod;
    sum[x] = (sum[ch[x][0]] + val[x] + sum[ch[x][1]]) % mod;
  }
  void pushdown(int x) {
    clear(0);
    if (mul[x] != 1) {
      if (ch[x][0])
        mul[ch[x][0]] = (mul[x] * mul[ch[x][0]]) % mod,
        val[ch[x][0]] = (val[ch[x][0]] * mul[x]) % mod,
        sum[ch[x][0]] = (sum[ch[x][0]] * mul[x]) % mod,
        add[ch[x][0]] = (add[ch[x][0]] * mul[x]) % mod;
      if (ch[x][1])
        mul[ch[x][1]] = (mul[x] * mul[ch[x][1]]) % mod,
        val[ch[x][1]] = (val[ch[x][1]] * mul[x]) % mod,
        sum[ch[x][1]] = (sum[ch[x][1]] * mul[x]) % mod,
        add[ch[x][1]] = (add[ch[x][1]] * mul[x]) % mod;
      mul[x] = 1;
    }
    if (add[x]) {
      if (ch[x][0])
        add[ch[x][0]] = (add[ch[x][0]] + add[x]) % mod,
        val[ch[x][0]] = (val[ch[x][0]] + add[x]) % mod,
        sum[ch[x][0]] = (sum[ch[x][0]] + add[x] * siz[ch[x][0]] % mod) % mod;
      if (ch[x][1])
        add[ch[x][1]] = (add[ch[x][1]] + add[x]) % mod,
        val[ch[x][1]] = (val[ch[x][1]] + add[x]) % mod,
        sum[ch[x][1]] = (sum[ch[x][1]] + add[x] * siz[ch[x][1]] % mod) % mod;
      add[x] = 0;
    }
    if (rev[x]) {
      if (ch[x][0]) rev[ch[x][0]] ^= 1, swap(ch[ch[x][0]][0], ch[ch[x][0]][1]);
      if (ch[x][1]) rev[ch[x][1]] ^= 1, swap(ch[ch[x][1]][0], ch[ch[x][1]][1]);
      rev[x] = 0;
    }
  }
  void update(int x) {
    if (!isroot(x)) update(fa[x]);
    pushdown(x);
  }
  void print(int x) {
    if (!x) return;
    pushdown(x);
    print(ch[x][0]);
    printf(&quot;%lld &quot;, x);
    print(ch[x][1]);
  }
  void rotate(int x) {
    int y = fa[x], z = fa[y], chx = getch(x), chy = getch(y);
    fa[x] = z;
    if (!isroot(y)) ch[z][chy] = x;
    ch[y][chx] = ch[x][chx ^ 1];
    fa[ch[x][chx ^ 1]] = y;
    ch[x][chx ^ 1] = y;
    fa[y] = x;
    maintain(y);
    maintain(x);
    maintain(z);
  }
  void splay(int x) {
    update(x);
    for (int f = fa[x]; f = fa[x], !isroot(x); rotate(x))
      if (!isroot(f)) rotate(getch(x) == getch(f) ? f : x);
  }
  void access(int x) {
    for (int f = 0; x; f = x, x = fa[x]) splay(x), ch[x][1] = f, maintain(x);
  }
  void makeroot(int x) {
    access(x);
    splay(x);
    swap(ch[x][0], ch[x][1]);
    rev[x] ^= 1;
  }
  int find(int x) {
    access(x);
    splay(x);
    while (ch[x][0]) x = ch[x][0];
    splay(x);
    return x;
  }
} st;
main() {
  scanf(&quot;%lld%lld&quot;, &amp;n, &amp;q);
  for (int i = 1; i &lt;= n; i++) st.val[i] = 1, st.maintain(i);
  for (int i = 1; i &lt; n; i++) {
    scanf(&quot;%lld%lld&quot;, &amp;u, &amp;v);
    if (st.find(u) != st.find(v)) st.makeroot(u), st.fa[u] = v;
  }
  while (q--) {
    scanf(&quot; %c%lld%lld&quot;, &amp;op, &amp;u, &amp;v);
    if (op == &apos;+&apos;) {
      scanf(&quot;%lld&quot;, &amp;c);
      st.makeroot(u), st.access(v), st.splay(v);
      st.val[v] = (st.val[v] + c) % mod;
      st.sum[v] = (st.sum[v] + st.siz[v] * c % mod) % mod;
      st.add[v] = (st.add[v] + c) % mod;
    }
    if (op == &apos;-&apos;) {
      st.makeroot(u);
      st.access(v);
      st.splay(v);
      if (st.ch[v][0] == u &amp;&amp; !st.ch[u][1]) st.ch[v][0] = st.fa[u] = 0;
      scanf(&quot;%lld%lld&quot;, &amp;u, &amp;v);
      if (st.find(u) != st.find(v)) st.makeroot(u), st.fa[u] = v;
    }
    if (op == &apos;*&apos;) {
      scanf(&quot;%lld&quot;, &amp;c);
      st.makeroot(u), st.access(v), st.splay(v);
      st.val[v] = st.val[v] * c % mod;
      st.sum[v] = st.sum[v] * c % mod;
      st.mul[v] = st.mul[v] * c % mod;
    }
    if (op == &apos;/&apos;)
      st.makeroot(u), st.access(v), st.splay(v), printf(&quot;%lld\n&quot;, st.sum[v]);
  }
  return 0;
}
```
</code></pre><h3 id="&#x4E60;&#x9898;">&#x4E60;&#x9898;</h3>
<ul>
<li><a href="https://www.luogu.org/problemnew/show/P3690" target="_blank">luogu P3690&#x3010;&#x6A21;&#x677F;&#x3011;Link Cut Tree&#xFF08;&#x52A8;&#x6001;&#x6811;&#xFF09;</a> </li>
<li><a href="https://www.luogu.org/problemnew/show/P2486" target="_blank">&#x300C;SDOI2011&#x300D;&#x67D3;&#x8272;</a> </li>
<li><a href="https://loj.ac/problem/2187" target="_blank">&#x300C;SHOI2014&#x300D;&#x4E09;&#x53C9;&#x795E;&#x7ECF;&#x6811;</a> </li>
</ul>
<h2 id="&#x7EF4;&#x62A4;&#x8FDE;&#x901A;&#x6027;&#x8D28;">&#x7EF4;&#x62A4;&#x8FDE;&#x901A;&#x6027;&#x8D28;</h2>
<h3 id="&#x5224;&#x65AD;&#x662F;&#x5426;&#x8FDE;&#x901A;">&#x5224;&#x65AD;&#x662F;&#x5426;&#x8FDE;&#x901A;</h3>
<p>&#x501F;&#x52A9; LCT &#x7684; <code>Find()</code> &#x51FD;&#x6570;&#xFF0C;&#x53EF;&#x4EE5;&#x5224;&#x65AD;&#x52A8;&#x6001;&#x68EE;&#x6797;&#x4E0A;&#x7684;&#x4E24;&#x70B9;&#x662F;&#x5426;&#x8FDE;&#x901A;&#x3002;&#x5982;&#x679C;&#x6709; <code>Find(x)==Find(y)</code> &#xFF0C;&#x5219;&#x8BF4;&#x660E; $x,y$ &#x4E24;&#x70B9;&#x5728;&#x4E00;&#x68F5;&#x6811;&#x4E0A;&#xFF0C;&#x76F8;&#x4E92;&#x8FDE;&#x901A;&#x3002;</p>
<p>???+note &quot; &#x4F8B;&#x9898;<a href="https://www.luogu.org/problemnew/show/P2147" target="_blank">&#x300C;SDOI2008&#x300D;&#x6D1E;&#x7A74;&#x52D8;&#x6D4B;</a>&quot;
    &#x4E00;&#x5F00;&#x59CB;&#x6709; $n$ &#x4E2A;&#x72EC;&#x7ACB;&#x7684;&#x70B9;&#xFF0C; $m$ &#x6B21;&#x64CD;&#x4F5C;&#x3002;&#x6BCF;&#x6B21;&#x64CD;&#x4F5C;&#x4E3A;&#x4EE5;&#x4E0B;&#x4E4B;&#x4E00;&#xFF1A;</p>
<pre><code>1.   `Connect u v` &#xFF1A;&#x5728; $u,v$ &#x4E24;&#x70B9;&#x4E4B;&#x95F4;&#x8FDE;&#x63A5;&#x4E00;&#x6761;&#x8FB9;&#x3002;
2.   `Destroy u v` &#xFF1A;&#x5220;&#x9664;&#x5728; $u,v$ &#x4E24;&#x70B9;&#x4E4B;&#x95F4;&#x7684;&#x8FB9;&#xFF0C;&#x4FDD;&#x8BC1;&#x4E4B;&#x524D;&#x5B58;&#x5728;&#x8FD9;&#x6837;&#x7684;&#x4E00;&#x6761;&#x8FB9;&#x3002;
3.   `Query u v` &#xFF1A;&#x8BE2;&#x95EE; $u,v$ &#x4E24;&#x70B9;&#x662F;&#x5426;&#x8FDE;&#x901A;&#x3002;

&#x4FDD;&#x8BC1;&#x5728;&#x4EFB;&#x4F55;&#x65F6;&#x523B;&#x56FE;&#x7684;&#x5F62;&#x6001;&#x90FD;&#x662F;&#x4E00;&#x4E2A;&#x68EE;&#x6797;&#x3002;

 $n\le 10^4, m\le 2\times 10^5$ 
</code></pre><p>??? &quot;&#x53C2;&#x8003;&#x4EE3;&#x7801;&quot;</p>
<pre><code>```cpp
#include &lt;algorithm&gt;
#include &lt;cstdio&gt;
#include &lt;cstring&gt;
using namespace std;
const int maxn = 10010;
struct Splay {
  int ch[maxn][2], fa[maxn], tag[maxn];
  void clear(int x) { ch[x][0] = ch[x][1] = fa[x] = tag[x] = 0; }
  int getch(int x) { return ch[fa[x]][1] == x; }
  int isroot(int x) { return ch[fa[x]][0] != x &amp;&amp; ch[fa[x]][1] != x; }
  void pushdown(int x) {
    if (tag[x]) {
      if (ch[x][0]) swap(ch[ch[x][0]][0], ch[ch[x][0]][1]), tag[ch[x][0]] ^= 1;
      if (ch[x][1]) swap(ch[ch[x][1]][0], ch[ch[x][1]][1]), tag[ch[x][1]] ^= 1;
      tag[x] = 0;
    }
  }
  void update(int x) {
    if (!isroot(x)) update(fa[x]);
    pushdown(x);
  }
  void rotate(int x) {
    int y = fa[x], z = fa[y], chx = getch(x), chy = getch(y);
    fa[x] = z;
    if (!isroot(y)) ch[z][chy] = x;
    ch[y][chx] = ch[x][chx ^ 1];
    fa[ch[x][chx ^ 1]] = y;
    ch[x][chx ^ 1] = y;
    fa[y] = x;
  }
  void splay(int x) {
    update(x);
    for (int f = fa[x]; f = fa[x], !isroot(x); rotate(x))
      if (!isroot(f)) rotate(getch(x) == getch(f) ? f : x);
  }
  void access(int x) {
    for (int f = 0; x; f = x, x = fa[x]) splay(x), ch[x][1] = f;
  }
  void makeroot(int x) {
    access(x);
    splay(x);
    swap(ch[x][0], ch[x][1]);
    tag[x] ^= 1;
  }
  int find(int x) {
    access(x);
    splay(x);
    while (ch[x][0]) x = ch[x][0];
    splay(x);
    return x;
  }
} st;
int n, q, x, y;
char op[maxn];
int main() {
  scanf(&quot;%d%d&quot;, &amp;n, &amp;q);
  while (q--) {
    scanf(&quot;%s%d%d&quot;, op, &amp;x, &amp;y);
    if (op[0] == &apos;Q&apos;) {
      if (st.find(x) == st.find(y))
        printf(&quot;Yes\n&quot;);
      else
        printf(&quot;No\n&quot;);
    }
    if (op[0] == &apos;C&apos;)
      if (st.find(x) != st.find(y)) st.makeroot(x), st.fa[x] = y;
    if (op[0] == &apos;D&apos;) {
      st.makeroot(x);
      st.access(y);
      st.splay(y);
      if (st.ch[y][0] == x &amp;&amp; !st.ch[x][1]) st.ch[y][0] = st.fa[x] = 0;
    }
  }
  return 0;
}
```
</code></pre><h3 id="&#x7EF4;&#x62A4;&#x8FB9;&#x53CC;&#x8FDE;&#x901A;&#x5206;&#x91CF;">&#x7EF4;&#x62A4;&#x8FB9;&#x53CC;&#x8FDE;&#x901A;&#x5206;&#x91CF;</h3>
<p>&#x5982;&#x679C;&#x8981;&#x6C42;&#x5C06;&#x8FB9;&#x53CC;&#x8FDE;&#x901A;&#x5206;&#x91CF;&#x7F29;&#x6210;&#x70B9;&#xFF0C;&#x6BCF;&#x6B21;&#x6DFB;&#x52A0;&#x4E00;&#x6761;&#x8FB9;&#xFF0C;&#x6240;&#x8FDE;&#x63A5;&#x7684;&#x6811;&#x4E0A;&#x7684;&#x4E24;&#x70B9;&#x5982;&#x679C;&#x76F8;&#x4E92;&#x8FDE;&#x901A;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x6761;&#x8DEF;&#x5F84;&#x4E0A;&#x7684;&#x6240;&#x6709;&#x70B9;&#x90FD;&#x4F1A;&#x88AB;&#x7F29;&#x6210;&#x4E00;&#x4E2A;&#x70B9;&#x3002;</p>
<p>???+note &quot; &#x4F8B;&#x9898;<a href="https://www.luogu.org/problemnew/show/P2542" target="_blank">&#x300C;AHOI2005&#x300D;&#x822A;&#x7EBF;&#x89C4;&#x5212;</a>&quot;
    &#x7ED9;&#x51FA; $n$ &#x4E2A;&#x70B9;&#xFF0C;&#x521D;&#x59CB;&#x65F6;&#x6709; $m$ &#x6761;&#x65E0;&#x5411;&#x8FB9;&#xFF0C; $q$ &#x6B21;&#x64CD;&#x4F5C;&#xFF0C;&#x6BCF;&#x6B21;&#x64CD;&#x4F5C;&#x4E3A;&#x4EE5;&#x4E0B;&#x4E4B;&#x4E00;&#xFF1A;</p>
<pre><code>1.   `0 u v` &#xFF1A;&#x5220;&#x9664; $u,v$ &#x4E4B;&#x95F4;&#x7684;&#x8FDE;&#x8FB9;&#xFF0C;&#x4FDD;&#x8BC1;&#x6B64;&#x65F6;&#x5B58;&#x5728;&#x8FD9;&#x6837;&#x7684;&#x4E00;&#x6761;&#x8FB9;&#x3002;
2.   `1 u v` &#xFF1A;&#x67E5;&#x8BE2;&#x6B64;&#x65F6; $u,v$ &#x4E24;&#x70B9;&#x4E4B;&#x95F4;&#x53EF;&#x80FD;&#x7684;&#x6240;&#x6709;&#x8DEF;&#x5F84;&#x5FC5;&#x987B;&#x7ECF;&#x8FC7;&#x7684;&#x8FB9;&#x7684;&#x6570;&#x91CF;&#x3002;

&#x4FDD;&#x8BC1;&#x56FE;&#x5728;&#x4EFB;&#x610F;&#x65F6;&#x523B;&#x90FD;&#x8FDE;&#x901A;&#x3002;

 $1&lt;n&lt;3\times 10^4,1&lt;m&lt;10^5,0\le q\le 4\times 10^4$ 
</code></pre><p>&#x53EF;&#x4EE5;&#x53D1;&#x73B0;&#xFF0C; $u,v$ &#x4E24;&#x70B9;&#x4E4B;&#x95F4;&#x7684;&#x6240;&#x6709;&#x53EF;&#x80FD;&#x8DEF;&#x5F84;&#x5FC5;&#x987B;&#x7ECF;&#x8FC7;&#x7684;&#x8FB9;&#x7684;&#x6570;&#x91CF;&#x4E3A;&#x5C06;&#x6240;&#x6709;&#x8FB9;&#x53CC;&#x8FDE;&#x901A;&#x5206;&#x91CF;&#x7F29;&#x6210;&#x70B9;&#x4E4B;&#x540E; $u$ &#x6240;&#x5728;&#x70B9;&#x548C; $v$ &#x6240;&#x5728;&#x70B9;&#x4E4B;&#x95F4;&#x7684;&#x8DEF;&#x5F84;&#x4E0A;&#x7684;&#x7ED3;&#x70B9;&#x6570; $-1$ &#x3002;</p>
<p>&#x7531;&#x4E8E;&#x9898;&#x76EE;&#x4E2D;&#x7684;&#x5220;&#x8FB9;&#x64CD;&#x4F5C;&#x4E0D;&#x597D;&#x8FDB;&#x884C;&#xFF0C;&#x6211;&#x4EEC;&#x8003;&#x8651;&#x79BB;&#x7EBF;&#x9006;&#x5411;&#x8FDB;&#x884C;&#x64CD;&#x4F5C;&#xFF0C;&#x6539;&#x5220;&#x8FB9;&#x4E3A;&#x52A0;&#x8FB9;&#x3002;</p>
<p>&#x52A0;&#x5165;&#x4E00;&#x6761;&#x8FB9;&#x65F6;&#xFF0C;&#x5982;&#x679C;&#x4E24;&#x70B9;&#x539F;&#x6765;&#x4E0D;&#x8FDE;&#x901A;&#xFF0C;&#x5219;&#x5728; LCT &#x4E0A;&#x8FDE;&#x63A5;&#x4E24;&#x70B9;&#xFF1B;&#x5426;&#x5219;&#x63D0;&#x53D6;&#x51FA;&#x52A0;&#x8FD9;&#x6761;&#x8FB9;&#x4E4B;&#x524D; LCT &#x4E0A;&#x8FD9;&#x4E24;&#x70B9;&#x4E4B;&#x95F4;&#x7684;&#x8DEF;&#x5F84;&#xFF0C;&#x904D;&#x5386;&#x8F85;&#x52A9;&#x6811;&#x4E0A;&#x7684;&#x8FD9;&#x4E2A;&#x5B50;&#x6811;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E;&#x904D;&#x5386;&#x4E86;&#x8FD9;&#x6761;&#x8DEF;&#x5F84;&#xFF0C;&#x5C06;&#x8FD9;&#x4E9B;&#x70B9;&#x5408;&#x5E76;&#xFF0C;&#x5229;&#x7528;&#x5E76;&#x67E5;&#x96C6;&#x7EF4;&#x62A4;&#x5408;&#x5E76;&#x7684;&#x4FE1;&#x606F;&#x3002;</p>
<p>&#x7528;&#x5408;&#x5E76;&#x540E;&#x5E76;&#x67E5;&#x96C6;&#x7684;&#x4EE3;&#x8868;&#x5143;&#x7D20;&#x4EE3;&#x66FF;&#x539F;&#x6765;&#x6811;&#x4E0A;&#x7684;&#x8DEF;&#x5F84;&#x3002;&#x6CE8;&#x610F;&#x4E4B;&#x540E;&#x7684;&#x6BCF;&#x6B21;&#x64CD;&#x4F5C;&#x90FD;&#x8981;&#x627E;&#x5230;&#x64CD;&#x4F5C;&#x70B9;&#x5728;&#x5E76;&#x67E5;&#x96C6;&#x4E0A;&#x7684;&#x4EE3;&#x8868;&#x5143;&#x7D20;&#x8FDB;&#x884C;&#x64CD;&#x4F5C;&#x3002;</p>
<p>??? &quot;&#x53C2;&#x8003;&#x4EE3;&#x7801;&quot;</p>
<pre><code>```cpp
#include &lt;algorithm&gt;
#include &lt;cstdio&gt;
#include &lt;cstring&gt;
#include &lt;map&gt;
using namespace std;
const int maxn = 200010;
int f[maxn];
int findp(int x) { return f[x] ? f[x] = findp(f[x]) : x; }
void merge(int x, int y) {
  x = findp(x);
  y = findp(y);
  if (x != y) f[x] = y;
}
struct Splay {
  int ch[maxn][2], fa[maxn], tag[maxn], siz[maxn];
  void clear(int x) { ch[x][0] = ch[x][1] = fa[x] = tag[x] = siz[x] = 0; }
  int getch(int x) { return ch[findp(fa[x])][1] == x; }
  int isroot(int x) {
    return ch[findp(fa[x])][0] != x &amp;&amp; ch[findp(fa[x])][1] != x;
  }
  void maintain(int x) {
    clear(0);
    if (x) siz[x] = siz[ch[x][0]] + 1 + siz[ch[x][1]];
  }
  void pushdown(int x) {
    if (tag[x]) {
      if (ch[x][0]) tag[ch[x][0]] ^= 1, swap(ch[ch[x][0]][0], ch[ch[x][0]][1]);
      if (ch[x][1]) tag[ch[x][1]] ^= 1, swap(ch[ch[x][1]][0], ch[ch[x][1]][1]);
      tag[x] = 0;
    }
  }
  void print(int x) {
    if (!x) return;
    pushdown(x);
    print(ch[x][0]);
    printf(&quot;%d &quot;, x);
    print(ch[x][1]);
  }
  void update(int x) {
    if (!isroot(x)) update(findp(fa[x]));
    pushdown(x);
  }
  void rotate(int x) {
    x = findp(x);
    int y = findp(fa[x]), z = findp(fa[y]), chx = getch(x), chy = getch(y);
    fa[x] = z;
    if (!isroot(y)) ch[z][chy] = x;
    ch[y][chx] = ch[x][chx ^ 1];
    fa[ch[x][chx ^ 1]] = y;
    ch[x][chx ^ 1] = y;
    fa[y] = x;
    maintain(y);
    maintain(x);
    if (z) maintain(z);
  }
  void splay(int x) {
    x = findp(x);
    update(x);
    for (int f = findp(fa[x]); f = findp(fa[x]), !isroot(x); rotate(x))
      if (!isroot(f)) rotate(getch(x) == getch(f) ? f : x);
  }
  void access(int x) {
    for (int f = 0; x; f = x, x = findp(fa[x]))
      splay(x), ch[x][1] = f, maintain(x);
  }
  void makeroot(int x) {
    x = findp(x);
    access(x);
    splay(x);
    tag[x] ^= 1;
    swap(ch[x][0], ch[x][1]);
  }
  int find(int x) {
    x = findp(x);
    access(x);
    splay(x);
    while (ch[x][0]) x = ch[x][0];
    splay(x);
    return x;
  }
  void dfs(int x) {
    pushdown(x);
    if (ch[x][0]) dfs(ch[x][0]), merge(ch[x][0], x);
    if (ch[x][1]) dfs(ch[x][1]), merge(ch[x][1], x);
  }
} st;
int n, m, q, x, y, cur, ans[maxn];
struct oper {
  int op, a, b;
} s[maxn];
map&lt;pair&lt;int, int&gt;, int&gt; mp;
int main() {
  scanf(&quot;%d%d&quot;, &amp;n, &amp;m);
  for (int i = 1; i &lt;= n; i++) st.maintain(i);
  for (int i = 1; i &lt;= m; i++)
    scanf(&quot;%d%d&quot;, &amp;x, &amp;y), mp[{x, y}] = mp[{y, x}] = 1;
  while (scanf(&quot;%d&quot;, &amp;s[++q].op)) {
    if (s[q].op == -1) {
      q--;
      break;
    }
    scanf(&quot;%d%d&quot;, &amp;s[q].a, &amp;s[q].b);
    if (!s[q].op) mp[{s[q].a, s[q].b}] = mp[{s[q].b, s[q].a}] = 0;
  }
  reverse(s + 1, s + q + 1);
  for (map&lt;pair&lt;int, int&gt;, int&gt;::iterator it = mp.begin(); it != mp.end(); it++)
    if (it-&gt;second) {
      mp[{it-&gt;first.second, it-&gt;first.first}] = 0;
      x = findp(it-&gt;first.first);
      y = findp(it-&gt;first.second);
      if (st.find(x) != st.find(y))
        st.makeroot(x), st.fa[x] = y;
      else {
        if (x == y) continue;
        st.makeroot(x);
        st.access(y);
        st.splay(y);
        st.dfs(y);
        int t = findp(y);
        st.fa[t] = findp(st.fa[y]);
        st.ch[t][0] = st.ch[t][1] = 0;
        st.maintain(t);
      }
    }
  for (int i = 1; i &lt;= q; i++) {
    if (s[i].op == 0) {
      x = findp(s[i].a);
      y = findp(s[i].b);
      st.makeroot(x);
      st.access(y);
      st.splay(y);
      st.dfs(y);
      int t = findp(y);
      st.fa[t] = st.fa[y];
      st.ch[t][0] = st.ch[t][1] = 0;
      st.maintain(t);
    }
    if (s[i].op == 1) {
      x = findp(s[i].a);
      y = findp(s[i].b);
      st.makeroot(x);
      st.access(y);
      st.splay(y);
      ans[++cur] = st.siz[y] - 1;
    }
  }
  for (int i = cur; i &gt;= 1; i--) printf(&quot;%d\n&quot;, ans[i]);
  return 0;
}
```
</code></pre><h3 id="&#x4E60;&#x9898;">&#x4E60;&#x9898;</h3>
<ul>
<li><a href="https://www.luogu.org/problemnew/show/P3950" target="_blank">luogu P3950 &#x90E8;&#x843D;&#x51B2;&#x7A81;</a> </li>
<li><a href="https://www.lydsy.com/JudgeOnline/problem.php?id=4998" target="_blank">bzoj 4998 &#x661F;&#x7403;&#x8054;&#x76DF;</a> </li>
<li><a href="https://www.lydsy.com/JudgeOnline/problem.php?id=2959" target="_blank">bzoj 2959 &#x957F;&#x8DD1;</a> </li>
</ul>
<h2 id="&#x7EF4;&#x62A4;&#x8FB9;&#x6743;">&#x7EF4;&#x62A4;&#x8FB9;&#x6743;</h2>
<p>LCT &#x5E76;&#x4E0D;&#x80FD;&#x76F4;&#x63A5;&#x5904;&#x7406;&#x8FB9;&#x6743;&#xFF0C;&#x6B64;&#x65F6;&#x9700;&#x8981;&#x5BF9;&#x6BCF;&#x6761;&#x8FB9;&#x5EFA;&#x7ACB;&#x4E00;&#x4E2A;&#x5BF9;&#x5E94;&#x70B9;&#xFF0C;&#x65B9;&#x4FBF;&#x67E5;&#x8BE2;&#x94FE;&#x4E0A;&#x7684;&#x8FB9;&#x4FE1;&#x606F;&#x3002;&#x5229;&#x7528;&#x8FD9;&#x4E00;&#x6280;&#x5DE7;&#x53EF;&#x4EE5;&#x52A8;&#x6001;&#x7EF4;&#x62A4;&#x751F;&#x6210;&#x6811;&#x3002;</p>
<p>???+note &quot; &#x4F8B;&#x9898;<a href="https://www.luogu.org/problemnew/show/P4234" target="_blank">luogu P4234 &#x6700;&#x5C0F;&#x5DEE;&#x503C;&#x751F;&#x6210;&#x6811;</a>&quot;
    &#x7ED9;&#x5B9A;&#x4E00;&#x4E2A; $n$ &#x4E2A;&#x70B9;&#xFF0C; $m$ &#x6761;&#x8FB9;&#x7684;&#x5E26;&#x6743;&#x65E0;&#x5411;&#x56FE;&#xFF0C;&#x6C42;&#x5176;&#x8FB9;&#x6743;&#x6700;&#x5927;&#x503C;&#x548C;&#x8FB9;&#x6743;&#x6700;&#x5C0F;&#x503C;&#x7684;&#x5DEE;&#x503C;&#x6700;&#x5C0F;&#x7684;&#x751F;&#x6210;&#x6811;&#xFF0C;&#x8F93;&#x51FA;&#x8FD9;&#x4E2A;&#x5DEE;&#x503C;&#x3002;</p>
<pre><code>&#x6570;&#x636E;&#x4FDD;&#x8BC1;&#x81F3;&#x5C11;&#x5B58;&#x5728;&#x4E00;&#x68F5;&#x751F;&#x6210;&#x6811;&#x3002;

 $1\le n\le 5\times 10^4,1\le m\le 2\times 10^5,1\le w_i\le 10^4$ 
</code></pre><p>&#x5C06;&#x8FB9;&#x6309;&#x7167;&#x8FB9;&#x6743;&#x4ECE;&#x5C0F;&#x5230;&#x5927;&#x6392;&#x5E8F;&#xFF0C;&#x679A;&#x4E3E;&#x9009;&#x62E9;&#x7684;&#x6700;&#x53F3;&#x8FB9;&#x7684;&#x4E00;&#x6761;&#x8FB9;&#xFF0C;&#x8981;&#x5F97;&#x5230;&#x6700;&#x4F18;&#x89E3;&#xFF0C;&#x9700;&#x8981;&#x4F7F;&#x8FB9;&#x6743;&#x6700;&#x5C0F;&#x8FB9;&#x7684;&#x8FB9;&#x6743;&#x6700;&#x5927;&#x3002;</p>
<p>&#x6BCF;&#x6B21;&#x6309;&#x7167;&#x987A;&#x5E8F;&#x6DFB;&#x52A0;&#x8FB9;&#xFF0C;&#x5982;&#x679C;&#x5C06;&#x8981;&#x8FDE;&#x63A5;&#x7684;&#x8FD9;&#x4E24;&#x4E2A;&#x70B9;&#x5DF2;&#x7ECF;&#x8FDE;&#x901A;&#xFF0C;&#x5219;&#x5220;&#x9664;&#x8FD9;&#x4E24;&#x70B9;&#x4E4B;&#x95F4;&#x8FB9;&#x6743;&#x6700;&#x5C0F;&#x7684;&#x4E00;&#x6761;&#x8FB9;&#x3002;&#x5982;&#x679C;&#x6574;&#x4E2A;&#x56FE;&#x5DF2;&#x7ECF;&#x8FDE;&#x901A;&#x6210;&#x4E86;&#x4E00;&#x68F5;&#x6811;&#xFF0C;&#x5219;&#x7528;&#x5F53;&#x524D;&#x8FB9;&#x6743;&#x51CF;&#x53BB;&#x6700;&#x5C0F;&#x8FB9;&#x6743;&#x66F4;&#x65B0;&#x7B54;&#x6848;&#x3002;&#x6700;&#x5C0F;&#x8FB9;&#x6743;&#x53EF;&#x7528;&#x53CC;&#x6307;&#x9488;&#x6CD5;&#x66F4;&#x65B0;&#x3002;</p>
<p>LCT &#x4E0A;&#x6CA1;&#x6709;&#x56FA;&#x5B9A;&#x7684;&#x7236;&#x5B50;&#x5173;&#x7CFB;&#xFF0C;&#x6240;&#x4EE5;&#x4E0D;&#x80FD;&#x5C06;&#x8FB9;&#x6743;&#x8BB0;&#x5F55;&#x5728;&#x70B9;&#x6743;&#x4E2D;&#x3002;</p>
<p>&#x8BB0;&#x5F55;&#x6811;&#x94FE;&#x4E0A;&#x7684;&#x8FB9;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; <strong>&#x62C6;&#x8FB9;</strong> &#x3002;&#x5BF9;&#x6BCF;&#x6761;&#x8FB9;&#x5EFA;&#x7ACB;&#x4E00;&#x4E2A;&#x5BF9;&#x5E94;&#x7684;&#x70B9;&#xFF0C;&#x4ECE;&#x8FD9;&#x6761;&#x8FB9;&#x5411;&#x5176;&#x4E24;&#x4E2A;&#x7AEF;&#x70B9;&#x8FDE;&#x63A5;&#x4E00;&#x6761;&#x8FB9;&#xFF0C;&#x539F;&#x5148;&#x7684;&#x8FDE;&#x8FB9;&#x4E0E;&#x5220;&#x8FB9;&#x64CD;&#x4F5C;&#x90FD;&#x53D8;&#x6210;&#x4E24;&#x6B21;&#x64CD;&#x4F5C;&#x3002;</p>
<p>??? &quot;&#x53C2;&#x8003;&#x4EE3;&#x7801;&quot;</p>
<pre><code>```cpp
#include &lt;algorithm&gt;
#include &lt;cstdio&gt;
#include &lt;cstring&gt;
#include &lt;set&gt;
using namespace std;
const int maxn = 5000010;
struct Splay {
  int ch[maxn][2], fa[maxn], tag[maxn], val[maxn], minn[maxn];
  void clear(int x) {
    ch[x][0] = ch[x][1] = fa[x] = tag[x] = val[x] = minn[x] = 0;
  }
  int getch(int x) { return ch[fa[x]][1] == x; }
  int isroot(int x) { return ch[fa[x]][0] != x &amp;&amp; ch[fa[x]][1] != x; }
  void maintain(int x) {
    if (!x) return;
    minn[x] = x;
    if (ch[x][0]) {
      if (val[minn[ch[x][0]]] &lt; val[minn[x]]) minn[x] = minn[ch[x][0]];
    }
    if (ch[x][1]) {
      if (val[minn[ch[x][1]]] &lt; val[minn[x]]) minn[x] = minn[ch[x][1]];
    }
  }
  void pushdown(int x) {
    if (tag[x]) {
      if (ch[x][0]) tag[ch[x][0]] ^= 1, swap(ch[ch[x][0]][0], ch[ch[x][0]][1]);
      if (ch[x][1]) tag[ch[x][1]] ^= 1, swap(ch[ch[x][1]][0], ch[ch[x][1]][1]);
      tag[x] = 0;
    }
  }
  void update(int x) {
    if (!isroot(x)) update(fa[x]);
    pushdown(x);
  }
  void print(int x) {
    if (!x) return;
    pushdown(x);
    print(ch[x][0]);
    printf(&quot;%d &quot;, x);
    print(ch[x][1]);
  }
  void rotate(int x) {
    int y = fa[x], z = fa[y], chx = getch(x), chy = getch(y);
    fa[x] = z;
    if (!isroot(y)) ch[z][chy] = x;
    ch[y][chx] = ch[x][chx ^ 1];
    fa[ch[x][chx ^ 1]] = y;
    ch[x][chx ^ 1] = y;
    fa[y] = x;
    maintain(y);
    maintain(x);
    if (z) maintain(z);
  }
  void splay(int x) {
    update(x);
    for (int f = fa[x]; f = fa[x], !isroot(x); rotate(x))
      if (!isroot(f)) rotate(getch(x) == getch(f) ? f : x);
  }
  void access(int x) {
    for (int f = 0; x; f = x, x = fa[x]) splay(x), ch[x][1] = f, maintain(x);
  }
  void makeroot(int x) {
    access(x);
    splay(x);
    tag[x] ^= 1;
    swap(ch[x][0], ch[x][1]);
  }
  int find(int x) {
    access(x);
    splay(x);
    while (ch[x][0]) x = ch[x][0];
    splay(x);
    return x;
  }
  void link(int x, int y) {
    makeroot(x);
    fa[x] = y;
  }
  void cut(int x, int y) {
    makeroot(x);
    access(y);
    splay(y);
    ch[y][0] = fa[x] = 0;
    maintain(y);
  }
} st;
const int inf = 2e9 + 1;
int n, m, ans, nww, x, y;
struct Edge {
  int u, v, w;
  bool operator&lt;(Edge x) const { return w &lt; x.w; };
} s[maxn];
multiset&lt;int&gt; mp;
int main() {
  scanf(&quot;%d%d&quot;, &amp;n, &amp;m);
  for (int i = 1; i &lt;= n; i++) st.val[i] = inf, st.maintain(i);
  for (int i = 1; i &lt;= m; i++) scanf(&quot;%d%d%d&quot;, &amp;s[i].u, &amp;s[i].v, &amp;s[i].w);
  sort(s + 1, s + m + 1);
  for (int i = 1; i &lt;= m; i++) st.val[n + i] = s[i].w, st.maintain(n + i);
  for (int i = 1; i &lt;= m; i++) {
    x = s[i].u;
    y = s[i].v;
    if (x == y) continue;
    if (st.find(x) != st.find(y)) {
      nww++;
      st.link(x, n + i);
      st.link(n + i, y);
      mp.insert(s[i].w);
      if (nww == n - 1) ans = s[i].w - (*(mp.begin()++));
    } else {
      st.makeroot(x);
      st.access(y);
      st.splay(y);
      int t = st.minn[y] - n;
      st.cut(s[t].u, t + n);
      st.cut(t + n, s[t].v);
      mp.erase(mp.find(s[t].w));
      st.link(x, n + i);
      st.link(n + i, y);
      mp.insert(s[i].w);
      if (nww == n - 1) ans = min(ans, s[i].w - (*(mp.begin()++)));
    }
  }
  printf(&quot;%d\n&quot;, ans);
  return 0;
}
```
</code></pre><h3 id="&#x4E60;&#x9898;">&#x4E60;&#x9898;</h3>
<ul>
<li><a href="https://www.luogu.org/problem/P4172" target="_blank">&#x300C;WC2006&#x300D;&#x6C34;&#x7BA1;&#x5C40;&#x957F;</a> </li>
<li><a href="https://www.luogu.org/problemnew/show/P4180" target="_blank">&#x300C;BJWC2010&#x300D;&#x4E25;&#x683C;&#x6B21;&#x5C0F;&#x751F;&#x6210;&#x6811;</a> </li>
<li><a href="http://uoj.ac/problem/3" target="_blank">&#x300C;NOI2014&#x300D;&#x9B54;&#x6CD5;&#x68EE;&#x6797;</a> </li>
</ul>
<h2 id="&#x7EF4;&#x62A4;&#x5B50;&#x6811;&#x4FE1;&#x606F;">&#x7EF4;&#x62A4;&#x5B50;&#x6811;&#x4FE1;&#x606F;</h2>
<p>LCT &#x4E0D;&#x64C5;&#x957F;&#x7EF4;&#x62A4;&#x5B50;&#x6811;&#x4FE1;&#x606F;&#x3002;&#x7EDF;&#x8BA1;&#x4E00;&#x4E2A;&#x7ED3;&#x70B9;&#x6240;&#x6709;&#x865A;&#x5B50;&#x6811;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x6C42;&#x5F97;&#x6574;&#x68F5;&#x6811;&#x7684;&#x4FE1;&#x606F;&#x3002;</p>
<p>???+note &quot; &#x4F8B;&#x9898;<a href="https://loj.ac/problem/2230" target="_blank">&#x300C;BJOI2014&#x300D;&#x5927;&#x878D;&#x5408;</a>&quot;
    &#x7ED9;&#x5B9A; $n$ &#x4E2A;&#x7ED3;&#x70B9;&#x548C; $q$ &#x6B21;&#x64CD;&#x4F5C;&#xFF0C;&#x6BCF;&#x4E2A;&#x64CD;&#x4F5C;&#x4E3A;&#x5982;&#x4E0B;&#x5F62;&#x5F0F;&#xFF1A;</p>
<pre><code>1.   `A x y` &#x5728;&#x7ED3;&#x70B9; $x$ &#x548C; $y$ &#x4E4B;&#x95F4;&#x8FDE;&#x63A5;&#x4E00;&#x6761;&#x8FB9;&#x3002;
2.   `Q x y` &#x7ED9;&#x5B9A;&#x4E00;&#x6761;&#x5DF2;&#x7ECF;&#x5B58;&#x5728;&#x7684;&#x8FB9; $(x,y)$ &#xFF0C;&#x6C42;&#x6709;&#x591A;&#x5C11;&#x6761;&#x7B80;&#x5355;&#x8DEF;&#x5F84;&#xFF0C;&#x5176;&#x4E2D;&#x5305;&#x542B;&#x8FB9; $(x,y)$ &#x3002;

&#x4FDD;&#x8BC1;&#x5728;&#x4EFB;&#x610F;&#x65F6;&#x523B;&#xFF0C;&#x56FE;&#x7684;&#x5F62;&#x6001;&#x90FD;&#x662F;&#x4E00;&#x68F5;&#x68EE;&#x6797;&#x3002;

 $1\le n,q,x,y\le 10^5$ 
</code></pre><p>&#x4E3A;&#x8BE2;&#x95EE; <code>Q</code> &#x8003;&#x8651;&#x53E6;&#x4E00;&#x79CD;&#x8868;&#x8FF0;&#xFF0C;&#x6211;&#x4EEC;&#x53D1;&#x73B0;&#x7B54;&#x6848;&#x7B49;&#x4E8E;&#x8FB9; $(x,y)$ &#x5728; $x$ &#x4FA7;&#x7684;&#x7ED3;&#x70B9;&#x6570;&#x4E0E; $y$ &#x4FA7;&#x7684;&#x7ED3;&#x70B9;&#x6570;&#x7684;&#x4E58;&#x79EF;&#xFF0C;&#x5373;&#x5C06;&#x8FB9; $(x,y)$ &#x65AD;&#x5F00;&#x540E;&#x5206;&#x522B;&#x5305;&#x542B; $x$ &#x548C; $y$ &#x7684;&#x6811;&#x7684;&#x7ED3;&#x70B9;&#x6570;&#x3002;&#x4E3A;&#x4E86;&#x6D88;&#x9664;&#x65AD;&#x8FB9;&#x7684;&#x5F71;&#x54CD;&#xFF0C;&#x5728;&#x8BE2;&#x95EE;&#x540E;&#x6211;&#x4EEC;&#x518D;&#x6B21;&#x8FDE;&#x63A5;&#x8FB9; $(x,y)$ &#x3002;</p>
<p>&#x9898;&#x76EE;&#x4E2D;&#x7684;&#x64CD;&#x4F5C;&#x65E2;&#x6709;&#x8FDE;&#x8FB9;&#xFF0C;&#x53C8;&#x6709;&#x5220;&#x8FB9;&#xFF0C;&#x8FD8;&#x4FDD;&#x8BC1;&#x5728;&#x4EFB;&#x610F;&#x65F6;&#x523B;&#x90FD;&#x662F;&#x4E00;&#x68F5;&#x68EE;&#x6797;&#xFF0C;&#x6211;&#x4EEC;&#x4E0D;&#x7531;&#x5F97;&#x60F3;&#x5230;&#x7528; LCT &#x6765;&#x7EF4;&#x62A4;&#x3002;&#x4F46;&#x662F;&#x8FD9;&#x9898;&#x4E2D; LCT &#x7EF4;&#x62A4;&#x7684;&#x662F;&#x5B50;&#x6811;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x4E0D;&#x50CF;&#x6211;&#x4EEC;&#x5370;&#x8C61;&#x4E2D;&#x7684;&#x7EF4;&#x62A4;&#x4E00;&#x6761;&#x94FE;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x800C; LCT &#x7684;&#x6784;&#x9020; <strong>&#x8BA4;&#x7236;&#x4E0D;&#x8BA4;&#x5B50;</strong> &#xFF0C;&#x4E0D;&#x65B9;&#x4FBF;&#x6211;&#x4EEC;&#x76F4;&#x63A5;&#x8FDB;&#x884C;&#x5B50;&#x6811;&#x7684;&#x7EDF;&#x8BA1;&#x3002;&#x600E;&#x4E48;&#x529E;&#x5462;&#xFF1F;</p>
<p>&#x65B9;&#x6CD5;&#x662F;&#x7EDF;&#x8BA1;&#x4E00;&#x4E2A;&#x7ED3;&#x70B9; $x$ &#x6240;&#x6709;&#x865A;&#x513F;&#x5B50;&#xFF08;&#x5373;&#x7236;&#x4EB2;&#x4E3A; $x$ &#xFF0C;&#x4F46; $x$ &#x5728; Splay &#x4E2D;&#x7684;&#x5DE6;&#x53F3;&#x513F;&#x5B50;&#x5E76;&#x4E0D;&#x5305;&#x542B; $x$ &#xFF09;&#x6240;&#x4EE3;&#x8868;&#x7684;&#x5B50;&#x6811;&#x7684;&#x8D21;&#x732E;&#x3002;</p>
<p>&#x5B9A;&#x4E49; $siz2[x]$ &#x4E3A;&#x7ED3;&#x70B9; $x$ &#x7684;&#x6240;&#x6709;&#x865A;&#x513F;&#x5B50;&#x4EE3;&#x8868;&#x7684;&#x5B50;&#x6811;&#x7684;&#x7ED3;&#x70B9;&#x6570;&#xFF0C; $siz[x]$ &#x4E3A; &#x7ED3;&#x70B9; $x$ &#x5B50;&#x6811;&#x4E2D;&#x7684;&#x7ED3;&#x70B9;&#x6570;&#x3002;</p>
<p>&#x4E0D;&#x540C;&#x4E8E;&#x4EE5;&#x5F80;&#x6211;&#x4EEC;&#x7EF4;&#x62A4; Splay &#x4E2D;&#x5B50;&#x6811;&#x7ED3;&#x70B9;&#x4E2A;&#x6570;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x6211;&#x4EEC;&#x5728;&#x8BA1;&#x7B97;&#x7ED3;&#x70B9; $x$ &#x5B50;&#x6811;&#x4E2D;&#x7684;&#x7ED3;&#x70B9;&#x6570;&#x65F6;&#xFF0C;&#x8FD8;&#x8981;&#x52A0;&#x4E0A; $siz2[x]$ &#xFF0C;&#x5373;</p>
<pre><code class="lang-cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">maintain</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>{
  clear(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">if</span> (x) siz[x] = siz[ch[x][<span class="hljs-number">0</span>]] + <span class="hljs-number">1</span> + siz[ch[x][<span class="hljs-number">1</span>]] + siz2[x];
}
</code></pre>
<p>&#x800C;&#x4E14;&#x5728;&#x6211;&#x4EEC; <strong>&#x6539;&#x53D8; Splay &#x7684;&#x5F62;&#x6001;</strong> &#xFF08;&#x5373;&#x6539;&#x53D8;&#x4E00;&#x4E2A;&#x7ED3;&#x70B9;&#x5728; Splay &#x4E0A;&#x7684;&#x5DE6;&#x53F3;&#x513F;&#x5B50;&#x6307;&#x5411;&#x65F6;&#xFF09;&#xFF0C;&#x9700;&#x8981;&#x53CA;&#x65F6;&#x4FEE;&#x6539; $siz2[x]$ &#x7684;&#x503C;&#x3002;</p>
<p>&#x5728; <code>Rotate(),Splay()</code> &#x64CD;&#x4F5C;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x90FD;&#x53EA;&#x662F;&#x6539;&#x53D8;&#x4E86; Splay &#x4E2D;&#x7ED3;&#x70B9;&#x7684;&#x76F8;&#x5BF9;&#x4F4D;&#x7F6E;&#xFF0C;&#x6CA1;&#x6709;&#x6539;&#x53D8;&#x4EFB;&#x610F;&#x4E00;&#x6761;&#x8FB9;&#x7684;&#x865A;&#x5B9E;&#x60C5;&#x51B5;&#xFF0C;&#x6240;&#x4EE5;&#x4E0D;&#x5BF9; $siz2[x]$ &#x8FDB;&#x884C;&#x4EFB;&#x4F55;&#x4FEE;&#x6539;&#x3002;</p>
<p>&#x5728; <code>access</code> &#x64CD;&#x4F5C;&#x4E2D;&#xFF0C;&#x5728;&#x6BCF;&#x6B21; splay &#x5B8C;&#x540E;&#xFF0C;&#x90FD;&#x4F1A;&#x6539;&#x53D8;&#x521A;&#x521A; splay &#x5B8C;&#x7684;&#x7ED3;&#x70B9;&#x7684;&#x53F3;&#x513F;&#x5B50;&#xFF0C;&#x5373;&#x8BE5;&#x7ED3;&#x70B9;&#x4E0E;&#x5176;&#x539F;&#x53F3;&#x513F;&#x5B50;&#x7684;&#x8FDE;&#x8FB9;&#x548C;&#x8BE5;&#x8282;&#x70B9;&#x548C;&#x65B0;&#x53F3;&#x513F;&#x5B50;&#x7684;&#x8FDE;&#x8FB9;&#x7684;&#x865A;&#x5B9E;&#x60C5;&#x51B5;&#x53D1;&#x751F;&#x4E86;&#x53D8;&#x5316;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x52A0;&#x4E0A;&#x65B0;&#x53D8;&#x6210;&#x865A;&#x8FB9;&#x6240;&#x8FDE;&#x7684;&#x5B50;&#x6811;&#x7684;&#x8D21;&#x732E;&#xFF0C;&#x51CF;&#x53BB;&#x521A;&#x521A;&#x53D8;&#x6210;&#x5B9E;&#x8FB9;&#x6240;&#x8FDE;&#x7684;&#x5B50;&#x6811;&#x7684;&#x8D21;&#x732E;&#x3002;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">access</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> f = <span class="hljs-number">0</span>; x; f = x, x = fa[x])
    splay(x), siz2[x] += siz[ch[x][<span class="hljs-number">1</span>]] - siz[f], ch[x][<span class="hljs-number">1</span>] = f, maintain(x);
}
</code></pre>
<p>&#x5728; <code>MakeRoot(),Find()</code> &#x64CD;&#x4F5C;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x90FD;&#x53EA;&#x662F;&#x8C03;&#x7528;&#x4E86;&#x4E4B;&#x524D;&#x7684;&#x51FD;&#x6570;&#x6216;&#x8005;&#x5728; Splay &#x4E0A;&#x6761;&#x8FB9;&#xFF0C;&#x5E76;&#x4E0D;&#x7528;&#x505A;&#x4EFB;&#x4F55;&#x4FEE;&#x6539;&#x3002;</p>
<p>&#x5728;&#x8FDE;&#x63A5;&#x4E24;&#x70B9;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x4FEE;&#x6539;&#x4E86;&#x4E00;&#x4E2A;&#x7ED3;&#x70B9;&#x7684;&#x7236;&#x4EB2;&#x3002;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5728;&#x7236;&#x4EB2;&#x7ED3;&#x70B9;&#x7684; $siz2$ &#x503C;&#x4E2D;&#x52A0;&#x4E0A;&#x65B0;&#x5B50;&#x7ED3;&#x70B9;&#x7684;&#x5B50;&#x6811;&#x5927;&#x5C0F;&#x8D21;&#x732E;&#x3002;</p>
<pre><code class="lang-cpp">st.makeroot(x);
st.makeroot(y);
st.fa[x] = y;
st.siz2[y] += st.siz[x];
</code></pre>
<p>&#x5728;&#x65AD;&#x5F00;&#x4E00;&#x6761;&#x8FB9;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x662F;&#x5220;&#x9664;&#x4E86; Splay &#x4E0A;&#x7684;&#x4E00;&#x6761;&#x5B9E;&#x8FB9;&#xFF0C; <code>Maintain</code> &#x64CD;&#x4F5C;&#x4F1A;&#x7EF4;&#x62A4;&#x8FD9;&#x4E9B;&#x4FE1;&#x606F;&#xFF0C;&#x4E0D;&#x9700;&#x8981;&#x505A;&#x4EFB;&#x4F55;&#x4FEE;&#x6539;&#x3002;</p>
<p>&#x4EE3;&#x7801;&#x4FEE;&#x6539;&#x7684;&#x7EC6;&#x8282;&#x8BB2;&#x5B8C;&#x4E86;&#xFF0C;&#x603B;&#x7ED3;&#x4E00;&#x4E0B; LCT &#x7EF4;&#x62A4;&#x5B50;&#x6811;&#x4FE1;&#x606F;&#x7684;&#x8981;&#x6C42;&#x4E0E;&#x65B9;&#x6CD5;&#xFF1A;</p>
<ol>
<li>&#x7EF4;&#x62A4;&#x7684;&#x4FE1;&#x606F;&#x8981;&#x6709; <strong>&#x53EF;&#x51CF;&#x6027;</strong> &#xFF0C;&#x5982;&#x5B50;&#x6811;&#x7ED3;&#x70B9;&#x6570;&#xFF0C;&#x5B50;&#x6811;&#x6743;&#x503C;&#x548C;&#xFF0C;&#x4F46;&#x4E0D;&#x80FD;&#x76F4;&#x63A5;&#x7EF4;&#x62A4;&#x5B50;&#x6811;&#x6700;&#x5927;&#x6700;&#x5C0F;&#x503C;&#xFF0C;&#x56E0;&#x4E3A;&#x5728;&#x5C06;&#x4E00;&#x6761;&#x865A;&#x8FB9;&#x53D8;&#x6210;&#x5B9E;&#x8FB9;&#x65F6;&#x8981;&#x6392;&#x9664;&#x539F;&#x5148;&#x865A;&#x8FB9;&#x7684;&#x8D21;&#x732E;&#x3002;</li>
<li>&#x65B0;&#x5EFA;&#x4E00;&#x4E2A;&#x9644;&#x52A0;&#x503C;&#x5B58;&#x50A8;&#x865A;&#x5B50;&#x6811;&#x7684;&#x8D21;&#x732E;&#xFF0C;&#x5728;&#x7EDF;&#x8BA1;&#x65F6;&#x5C06;&#x5176;&#x52A0;&#x5165;&#x672C;&#x7ED3;&#x70B9;&#x7B54;&#x6848;&#xFF0C;&#x5728;&#x6539;&#x53D8;&#x8FB9;&#x7684;&#x865A;&#x5B9E;&#x65F6;&#x53CA;&#x65F6;&#x7EF4;&#x62A4;&#x3002;</li>
<li>&#x5176;&#x4F59;&#x90E8;&#x5206;&#x540C;&#x666E;&#x901A; LCT&#xFF0C;&#x5728;&#x7EDF;&#x8BA1;&#x5B50;&#x6811;&#x4FE1;&#x606F;&#x65F6;&#x4E00;&#x5B9A;&#x5C06;&#x5176;&#x4F5C;&#x4E3A;&#x6839;&#x8282;&#x70B9;&#x3002;</li>
<li>&#x5982;&#x679C;&#x7EF4;&#x62A4;&#x7684;&#x4FE1;&#x606F;&#x6CA1;&#x6709;&#x53EF;&#x51CF;&#x6027;&#xFF0C;&#x5982;&#x7EF4;&#x62A4;&#x533A;&#x95F4;&#x6700;&#x503C;&#xFF0C;&#x53EF;&#x4EE5;&#x5BF9;&#x6BCF;&#x4E2A;&#x7ED3;&#x70B9;&#x5F00;&#x4E00;&#x4E2A;&#x5E73;&#x8861;&#x6811;&#x7EF4;&#x62A4;&#x7ED3;&#x70B9;&#x7684;&#x865A;&#x5B50;&#x6811;&#x4E2D;&#x7684;&#x6700;&#x503C;&#x3002;</li>
</ol>
<p>??? &quot;&#x53C2;&#x8003;&#x4EE3;&#x7801;&quot;</p>
<pre><code>```cpp
#include &lt;algorithm&gt;
#include &lt;cstdio&gt;
#include &lt;cstring&gt;
using namespace std;
const int maxn = 100010;
typedef long long ll;
struct Splay {
  int ch[maxn][2], fa[maxn], siz[maxn], siz2[maxn], tag[maxn];
  void clear(int x) {
    ch[x][0] = ch[x][1] = fa[x] = siz[x] = siz2[x] = tag[x] = 0;
  }
  int getch(int x) { return ch[fa[x]][1] == x; }
  int isroot(int x) { return ch[fa[x]][0] != x &amp;&amp; ch[fa[x]][1] != x; }
  void maintain(int x) {
    clear(0);
    if (x) siz[x] = siz[ch[x][0]] + 1 + siz[ch[x][1]] + siz2[x];
  }
  void pushdown(int x) {
    if (tag[x]) {
      if (ch[x][0]) swap(ch[ch[x][0]][0], ch[ch[x][0]][1]), tag[ch[x][0]] ^= 1;
      if (ch[x][1]) swap(ch[ch[x][1]][0], ch[ch[x][1]][1]), tag[ch[x][1]] ^= 1;
      tag[x] = 0;
    }
  }
  void update(int x) {
    if (!isroot(x)) update(fa[x]);
    pushdown(x);
  }
  void rotate(int x) {
    int y = fa[x], z = fa[y], chx = getch(x), chy = getch(y);
    fa[x] = z;
    if (!isroot(y)) ch[z][chy] = x;
    ch[y][chx] = ch[x][chx ^ 1];
    fa[ch[x][chx ^ 1]] = y;
    ch[x][chx ^ 1] = y;
    fa[y] = x;
    maintain(y);
    maintain(x);
    maintain(z);
  }
  void splay(int x) {
    update(x);
    for (int f = fa[x]; f = fa[x], !isroot(x); rotate(x))
      if (!isroot(f)) rotate(getch(x) == getch(f) ? f : x);
  }
  void access(int x) {
    for (int f = 0; x; f = x, x = fa[x])
      splay(x), siz2[x] += siz[ch[x][1]] - siz[f], ch[x][1] = f, maintain(x);
  }
  void makeroot(int x) {
    access(x);
    splay(x);
    swap(ch[x][0], ch[x][1]);
    tag[x] ^= 1;
  }
  int find(int x) {
    access(x);
    splay(x);
    while (ch[x][0]) x = ch[x][0];
    splay(x);
    return x;
  }
} st;
int n, q, x, y;
char op;
int main() {
  scanf(&quot;%d%d&quot;, &amp;n, &amp;q);
  while (q--) {
    scanf(&quot; %c%d%d&quot;, &amp;op, &amp;x, &amp;y);
    if (op == &apos;A&apos;) {
      st.makeroot(x);
      st.makeroot(y);
      st.fa[x] = y;
      st.siz2[y] += st.siz[x];
    }
    if (op == &apos;Q&apos;) {
      st.makeroot(x);
      st.access(y);
      st.splay(y);
      st.ch[y][0] = st.fa[x] = 0;
      st.maintain(x);
      st.makeroot(x);
      st.makeroot(y);
      printf(&quot;%lld\n&quot;, (ll)(st.siz[x] * st.siz[y]));
      st.makeroot(x);
      st.makeroot(y);
      st.fa[x] = y;
      st.siz2[y] += st.siz[x];
    }
  }
  return 0;
}
```
</code></pre><h3 id="&#x4E60;&#x9898;">&#x4E60;&#x9898;</h3>
<ul>
<li><a href="https://www.luogu.org/problemnew/show/P4299" target="_blank">luogu P4299 &#x9996;&#x90FD;</a> </li>
<li><a href="https://www.luogu.org/problemnew/show/SP2939" target="_blank">SPOJ QTREE5 - Query on a tree V</a> </li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                
                <a href="ett.html" class="navigation navigation-next navigation-unique" aria-label="Next page: Euler Tour Tree">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Link Cut Tree","level":"1.9.20.1","depth":3,"next":{"title":"Euler Tour Tree","level":"1.9.20.2","depth":3,"path":"docs/ds/ett.md","ref":"docs/ds/ett.md","articles":[]},"previous":{"title":"[动态树]","level":"1.9.20","depth":2,"ref":"","articles":[{"title":"Link Cut Tree","level":"1.9.20.1","depth":3,"path":"docs/ds/lct.md","ref":"docs/ds/lct.md","articles":[]},{"title":"Euler Tour Tree","level":"1.9.20.2","depth":3,"path":"docs/ds/ett.md","ref":"docs/ds/ett.md","articles":[]},{"title":"Top Tree","level":"1.9.20.3","depth":3,"path":"docs/ds/top-tree.md","ref":"docs/ds/top-tree.md","articles":[]}]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"docs/ds/lct.md","mtime":"2019-10-11T02:45:52.806Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-10-11T09:55:09.799Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

